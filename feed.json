{
    "version": "https://jsonfeed.org/version/1",
    "title": null,
    "subtitle": "",
    "icon": "https://dreamdivination.gitee.io/images/favicon.ico",
    "description": "",
    "home_page_url": "https://dreamdivination.gitee.io",
    "items": [
        {
            "id": "https://dreamdivination.gitee.io/2022/04/02/CAP%E7%90%86%E8%AE%BA/",
            "url": "https://dreamdivination.gitee.io/2022/04/02/CAP%E7%90%86%E8%AE%BA/",
            "title": "CAP理论",
            "date_published": "2022-04-01T16:00:00.000Z",
            "content_html": "<h1 id=\"概述\"><a class=\"anchor\" href=\"#概述\">#</a> 概述</h1>\n<blockquote>\n<p>CAP 原则又称 CAP 定理，指的是在一个分布式系统中，一致性（Consistency）、可用性（Availability）、分区容错性（Partition tolerance）。CAP 原则指的是，这三个要素最多只能同时实现两点，不可能三者兼顾。</p>\n</blockquote>\n",
            "tags": [
                "注册中心",
                "微服务"
            ]
        },
        {
            "id": "https://dreamdivination.gitee.io/2022/04/01/Swagger/",
            "url": "https://dreamdivination.gitee.io/2022/04/01/Swagger/",
            "title": "Swagger",
            "date_published": "2022-03-31T16:00:00.000Z",
            "content_html": "<h1 id=\"swagger-2-3-的区别\"><a class=\"anchor\" href=\"#swagger-2-3-的区别\">#</a> Swagger 2 &amp; 3 的区别</h1>\n<h2 id=\"依赖\"><a class=\"anchor\" href=\"#依赖\">#</a> 依赖</h2>\n<blockquote>\n<p>Swagger 2</p>\n</blockquote>\n<figure class=\"highlight xml\"><figcaption data-lang=\"XML\"></figcaption><table><tr><td data-num=\"1\"></td><td><pre><span class=\"token tag\"><span class=\"token tag\"><span class=\"token punctuation\">&lt;</span>dependency</span><span class=\"token punctuation\">></span></span></pre></td></tr><tr><td data-num=\"2\"></td><td><pre>  <span class=\"token tag\"><span class=\"token tag\"><span class=\"token punctuation\">&lt;</span>groupId</span><span class=\"token punctuation\">></span></span>io.springfox<span class=\"token tag\"><span class=\"token tag\"><span class=\"token punctuation\">&lt;/</span>groupId</span><span class=\"token punctuation\">></span></span></pre></td></tr><tr><td data-num=\"3\"></td><td><pre>  <span class=\"token tag\"><span class=\"token tag\"><span class=\"token punctuation\">&lt;</span>artifactId</span><span class=\"token punctuation\">></span></span>springfox-swagger2<span class=\"token tag\"><span class=\"token tag\"><span class=\"token punctuation\">&lt;/</span>artifactId</span><span class=\"token punctuation\">></span></span></pre></td></tr><tr><td data-num=\"4\"></td><td><pre>  <span class=\"token tag\"><span class=\"token tag\"><span class=\"token punctuation\">&lt;</span>version</span><span class=\"token punctuation\">></span></span>3.0.0<span class=\"token tag\"><span class=\"token tag\"><span class=\"token punctuation\">&lt;/</span>version</span><span class=\"token punctuation\">></span></span></pre></td></tr><tr><td data-num=\"5\"></td><td><pre><span class=\"token tag\"><span class=\"token tag\"><span class=\"token punctuation\">&lt;/</span>dependency</span><span class=\"token punctuation\">></span></span></pre></td></tr><tr><td data-num=\"6\"></td><td><pre><span class=\"token tag\"><span class=\"token tag\"><span class=\"token punctuation\">&lt;</span>dependency</span><span class=\"token punctuation\">></span></span></pre></td></tr><tr><td data-num=\"7\"></td><td><pre>  <span class=\"token tag\"><span class=\"token tag\"><span class=\"token punctuation\">&lt;</span>groupId</span><span class=\"token punctuation\">></span></span>io.springfox<span class=\"token tag\"><span class=\"token tag\"><span class=\"token punctuation\">&lt;/</span>groupId</span><span class=\"token punctuation\">></span></span></pre></td></tr><tr><td data-num=\"8\"></td><td><pre>  <span class=\"token tag\"><span class=\"token tag\"><span class=\"token punctuation\">&lt;</span>artifactId</span><span class=\"token punctuation\">></span></span>springfox-swagger-ui<span class=\"token tag\"><span class=\"token tag\"><span class=\"token punctuation\">&lt;/</span>artifactId</span><span class=\"token punctuation\">></span></span></pre></td></tr><tr><td data-num=\"9\"></td><td><pre>  <span class=\"token tag\"><span class=\"token tag\"><span class=\"token punctuation\">&lt;</span>version</span><span class=\"token punctuation\">></span></span>3.0.0<span class=\"token tag\"><span class=\"token tag\"><span class=\"token punctuation\">&lt;/</span>version</span><span class=\"token punctuation\">></span></span></pre></td></tr><tr><td data-num=\"10\"></td><td><pre><span class=\"token tag\"><span class=\"token tag\"><span class=\"token punctuation\">&lt;/</span>dependency</span><span class=\"token punctuation\">></span></span></pre></td></tr></table></figure><blockquote>\n<p>Swagger 3</p>\n</blockquote>\n<figure class=\"highlight xml\"><figcaption data-lang=\"XML\"></figcaption><table><tr><td data-num=\"1\"></td><td><pre><span class=\"token tag\"><span class=\"token tag\"><span class=\"token punctuation\">&lt;</span>dependency</span><span class=\"token punctuation\">></span></span></pre></td></tr><tr><td data-num=\"2\"></td><td><pre>  <span class=\"token tag\"><span class=\"token tag\"><span class=\"token punctuation\">&lt;</span>groupId</span><span class=\"token punctuation\">></span></span>io.springfox<span class=\"token tag\"><span class=\"token tag\"><span class=\"token punctuation\">&lt;/</span>groupId</span><span class=\"token punctuation\">></span></span></pre></td></tr><tr><td data-num=\"3\"></td><td><pre>  <span class=\"token tag\"><span class=\"token tag\"><span class=\"token punctuation\">&lt;</span>artifactId</span><span class=\"token punctuation\">></span></span>springfox-boot-starter<span class=\"token tag\"><span class=\"token tag\"><span class=\"token punctuation\">&lt;/</span>artifactId</span><span class=\"token punctuation\">></span></span></pre></td></tr><tr><td data-num=\"4\"></td><td><pre>  <span class=\"token tag\"><span class=\"token tag\"><span class=\"token punctuation\">&lt;</span>version</span><span class=\"token punctuation\">></span></span>3.0.0<span class=\"token tag\"><span class=\"token tag\"><span class=\"token punctuation\">&lt;/</span>version</span><span class=\"token punctuation\">></span></span></pre></td></tr><tr><td data-num=\"5\"></td><td><pre><span class=\"token tag\"><span class=\"token tag\"><span class=\"token punctuation\">&lt;/</span>dependency</span><span class=\"token punctuation\">></span></span></pre></td></tr></table></figure><h2 id=\"启用方式\"><a class=\"anchor\" href=\"#启用方式\">#</a> 启用方式</h2>\n<blockquote>\n<p>Swagger 2</p>\n</blockquote>\n<figure class=\"highlight java\"><figcaption data-lang=\"java\"></figcaption><table><tr><td data-num=\"1\"></td><td><pre><span class=\"token annotation punctuation\">@EnableSwagger2</span></pre></td></tr></table></figure><blockquote>\n<p>Swagger 3</p>\n</blockquote>\n<figure class=\"highlight java\"><figcaption data-lang=\"java\"></figcaption><table><tr><td data-num=\"1\"></td><td><pre><span class=\"token annotation punctuation\">@EnableOpenApi</span></pre></td></tr></table></figure><h2 id=\"访问方式\"><a class=\"anchor\" href=\"#访问方式\">#</a> 访问方式</h2>\n<blockquote>\n<p>Swagger 2：ip:port/swagger-ui.html<br />\nSwagger 3：ip:port/swagger-ui/index.html</p>\n</blockquote>\n<h2 id=\"doucument-类型\"><a class=\"anchor\" href=\"#doucument-类型\">#</a> Doucument 类型</h2>\n<blockquote>\n<p>Swagger 2：DocumentationType.SWAGGER_2<br />\nSwagger 3：DocumentationType.OAS_30</p>\n</blockquote>\n<h1 id=\"注解\"><a class=\"anchor\" href=\"#注解\">#</a> 注解</h1>\n<h2 id=\"api请求类的说明\"><a class=\"anchor\" href=\"#api请求类的说明\">#</a> @Api：请求类的说明</h2>\n<figure class=\"highlight java\"><figcaption data-lang=\"java\"></figcaption><table><tr><td data-num=\"1\"></td><td><pre><span class=\"token annotation punctuation\">@Api</span><span class=\"token punctuation\">(</span>value <span class=\"token operator\">=</span> <span class=\"token string\">\"\"</span><span class=\"token punctuation\">,</span> tags <span class=\"token operator\">=</span> <span class=\"token string\">\"\"</span><span class=\"token punctuation\">,</span> produces <span class=\"token operator\">=</span> <span class=\"token string\">\"\"</span><span class=\"token punctuation\">,</span> consumes <span class=\"token operator\">=</span> <span class=\"token string\">\"\"</span><span class=\"token punctuation\">,</span> protocols <span class=\"token operator\">=</span> <span class=\"token string\">\"\"</span><span class=\"token punctuation\">,</span> authorizations <span class=\"token operator\">=</span> <span class=\"token annotation punctuation\">@Authorization</span><span class=\"token punctuation\">(</span><span class=\"token string\">\"\"</span><span class=\"token punctuation\">)</span><span class=\"token punctuation\">,</span> hidden <span class=\"token operator\">=</span> <span class=\"token boolean\">false</span><span class=\"token punctuation\">)</span></pre></td></tr></table></figure><table>\n<thead>\n<tr>\n<th>属性名称</th>\n<th>说明</th>\n</tr>\n</thead>\n<tbody>\n<tr>\n<td>value</td>\n<td>url 的路径值</td>\n</tr>\n<tr>\n<td>tags</td>\n<td>该类的作用</td>\n</tr>\n<tr>\n<td>produces</td>\n<td>对 Api 资源的描述</td>\n</tr>\n<tr>\n<td>consumes</td>\n<td>如，“application/json, application/xml”</td>\n</tr>\n<tr>\n<td>protocols</td>\n<td>协议类型，如: http, https, ws, wss.</td>\n</tr>\n<tr>\n<td>authorizations</td>\n<td>高级特性认证时配置</td>\n</tr>\n<tr>\n<td>hidden</td>\n<td>配置为 true ，将在文档中隐藏</td>\n</tr>\n</tbody>\n</table>\n<h2 id=\"apioperation方法的说明\"><a class=\"anchor\" href=\"#apioperation方法的说明\">#</a> @ApiOperation：方法的说明</h2>\n<figure class=\"highlight java\"><figcaption data-lang=\"java\"></figcaption><table><tr><td data-num=\"1\"></td><td><pre><span class=\"token annotation punctuation\">@ApiOperation</span><span class=\"token punctuation\">(</span>value <span class=\"token operator\">=</span> <span class=\"token string\">\"\"</span><span class=\"token punctuation\">,</span> notes <span class=\"token operator\">=</span> <span class=\"token string\">\"\"</span><span class=\"token punctuation\">,</span> tags <span class=\"token operator\">=</span> <span class=\"token string\">\"\"</span><span class=\"token punctuation\">,</span> response <span class=\"token operator\">=</span> <span class=\"token class-name\">Void</span><span class=\"token punctuation\">.</span><span class=\"token keyword\">class</span><span class=\"token punctuation\">,</span> responseContainer <span class=\"token operator\">=</span> <span class=\"token string\">\"\"</span><span class=\"token punctuation\">,</span> responseReference <span class=\"token operator\">=</span> <span class=\"token string\">\"\"</span><span class=\"token punctuation\">,</span> httpMethod <span class=\"token operator\">=</span> <span class=\"token string\">\"\"</span><span class=\"token punctuation\">,</span> nickname <span class=\"token operator\">=</span> <span class=\"token string\">\"\"</span><span class=\"token punctuation\">,</span> produces <span class=\"token operator\">=</span> <span class=\"token string\">\"\"</span><span class=\"token punctuation\">,</span> consumes <span class=\"token operator\">=</span> <span class=\"token string\">\"\"</span><span class=\"token punctuation\">,</span> protocols <span class=\"token operator\">=</span> <span class=\"token string\">\"\"</span><span class=\"token punctuation\">,</span> authorizations <span class=\"token operator\">=</span> <span class=\"token annotation punctuation\">@Authorization</span><span class=\"token punctuation\">(</span><span class=\"token string\">\"\"</span><span class=\"token punctuation\">)</span><span class=\"token punctuation\">,</span> hidden <span class=\"token operator\">=</span> <span class=\"token boolean\">false</span><span class=\"token punctuation\">,</span>responseHeaders <span class=\"token operator\">=</span><span class=\"token annotation punctuation\">@ResponseHeader</span><span class=\"token punctuation\">(</span></pre></td></tr><tr><td data-num=\"2\"></td><td><pre>            name <span class=\"token operator\">=</span> <span class=\"token string\">\"\"</span><span class=\"token punctuation\">,</span></pre></td></tr><tr><td data-num=\"3\"></td><td><pre>            response <span class=\"token operator\">=</span> <span class=\"token class-name\">Void</span><span class=\"token punctuation\">.</span><span class=\"token keyword\">class</span></pre></td></tr><tr><td data-num=\"4\"></td><td><pre>    <span class=\"token punctuation\">)</span><span class=\"token punctuation\">,</span>code <span class=\"token operator\">=</span> <span class=\"token number\">200</span><span class=\"token punctuation\">,</span>extensions <span class=\"token operator\">=</span><span class=\"token annotation punctuation\">@Extension</span><span class=\"token punctuation\">(</span></pre></td></tr><tr><td data-num=\"5\"></td><td><pre>            properties <span class=\"token operator\">=</span> <span class=\"token punctuation\">&#123;</span><span class=\"token annotation punctuation\">@ExtensionProperty</span><span class=\"token punctuation\">(</span></pre></td></tr><tr><td data-num=\"6\"></td><td><pre>                    name <span class=\"token operator\">=</span> <span class=\"token string\">\"\"</span><span class=\"token punctuation\">,</span></pre></td></tr><tr><td data-num=\"7\"></td><td><pre>                    value <span class=\"token operator\">=</span> <span class=\"token string\">\"\"</span></pre></td></tr><tr><td data-num=\"8\"></td><td><pre>            <span class=\"token punctuation\">)</span><span class=\"token punctuation\">&#125;</span></pre></td></tr><tr><td data-num=\"9\"></td><td><pre>    <span class=\"token punctuation\">)</span><span class=\"token punctuation\">,</span>ignoreJsonView <span class=\"token operator\">=</span> <span class=\"token boolean\">false</span> <span class=\"token punctuation\">)</span></pre></td></tr></table></figure><table>\n<thead>\n<tr>\n<th>属性名称</th>\n<th>说明</th>\n</tr>\n</thead>\n<tbody>\n<tr>\n<td>value</td>\n<td>说明方法的作用</td>\n</tr>\n<tr>\n<td>notes</td>\n<td>方法的备注说明</td>\n</tr>\n<tr>\n<td>tags</td>\n<td>tag 列表，可用于按自愿或任何其它限定符对操作进行逻辑分组</td>\n</tr>\n<tr>\n<td>response</td>\n<td>接口返回类型</td>\n</tr>\n<tr>\n<td>responseContainer</td>\n<td>声明包装响应的容器。有效值为 List,Set,Map，任何其它值都将被忽略</td>\n</tr>\n<tr>\n<td>responseReference</td>\n<td>指定对响应类型的引用，本地 / 远程引用，并将覆盖任何其它指定的 response () 类</td>\n</tr>\n<tr>\n<td>httpMethod</td>\n<td>请求方式:“GET”, “HEAD”, “POST”, “PUT”, “DELETE”, “OPTIONS” and “PATCH”, 如果未指定则使用除 &quot;PATH&quot; 之外的其它所有</td>\n</tr>\n<tr>\n<td>nickname</td>\n<td>第三方工具使用 operationId 来唯一表示此操作</td>\n</tr>\n<tr>\n<td>produces</td>\n<td>采用逗号分隔的 content types 类型的返回数据，例如:application/json,application/xml</td>\n</tr>\n<tr>\n<td>consumes</td>\n<td>采用逗号分隔的 content types 类型的入参数据类型，例如:application/json,application/xml</td>\n</tr>\n<tr>\n<td>protocols</td>\n<td>指定协议类型:http,https,ws,wss, 多个协议使用逗号进行分隔</td>\n</tr>\n<tr>\n<td>authorizations</td>\n<td>获取此操作的授权列表</td>\n</tr>\n<tr>\n<td>hidden</td>\n<td>是否隐藏操作列表中的操作</td>\n</tr>\n<tr>\n<td>responseHeaders</td>\n<td>指定 response header 信息列表</td>\n</tr>\n<tr>\n<td>code</td>\n<td>HTTP 返回状态码</td>\n</tr>\n<tr>\n<td>extensions</td>\n<td>可选的扩展数组</td>\n</tr>\n<tr>\n<td>ignoreJsonView</td>\n<td></td>\n</tr>\n</tbody>\n</table>\n<h2 id=\"apiimplicitparams用在请求的方法上包含多-apiimplicitparam-或者-apiparam\"><a class=\"anchor\" href=\"#apiimplicitparams用在请求的方法上包含多-apiimplicitparam-或者-apiparam\">#</a> @ApiImplicitParams：用在请求的方法上，包含多 @ApiImplicitParam 或者 @ApiParam</h2>\n<figure class=\"highlight java\"><figcaption data-lang=\"java\"></figcaption><table><tr><td data-num=\"1\"></td><td><pre><span class=\"token annotation punctuation\">@ApiImplicitParams</span><span class=\"token punctuation\">(</span>value <span class=\"token operator\">=</span> <span class=\"token punctuation\">&#123;</span><span class=\"token punctuation\">&#125;</span><span class=\"token punctuation\">)</span></pre></td></tr></table></figure><table>\n<thead>\n<tr>\n<th>属性名称</th>\n<th>说明</th>\n</tr>\n</thead>\n<tbody>\n<tr>\n<td>value</td>\n<td>API 可用的参数列表（@ApiImplicitParam）</td>\n</tr>\n</tbody>\n</table>\n<h3 id=\"apiimplicitparam用于方法表示单独的请求参数\"><a class=\"anchor\" href=\"#apiimplicitparam用于方法表示单独的请求参数\">#</a> @ApiImplicitParam：用于方法，表示单独的请求参数</h3>\n<figure class=\"highlight java\"><figcaption data-lang=\"java\"></figcaption><table><tr><td data-num=\"1\"></td><td><pre><span class=\"token annotation punctuation\">@ApiImplicitParam</span><span class=\"token punctuation\">(</span>name <span class=\"token operator\">=</span> <span class=\"token string\">\"\"</span><span class=\"token punctuation\">,</span> value <span class=\"token operator\">=</span> <span class=\"token string\">\"\"</span><span class=\"token punctuation\">,</span> defaultValue <span class=\"token operator\">=</span> <span class=\"token string\">\"\"</span><span class=\"token punctuation\">,</span> allowableValues <span class=\"token operator\">=</span> <span class=\"token string\">\"\"</span><span class=\"token punctuation\">,</span> required <span class=\"token operator\">=</span> <span class=\"token boolean\">false</span><span class=\"token punctuation\">,</span> access <span class=\"token operator\">=</span> <span class=\"token string\">\"\"</span><span class=\"token punctuation\">,</span> allowMultiple <span class=\"token operator\">=</span> <span class=\"token boolean\">false</span><span class=\"token punctuation\">,</span> dataType <span class=\"token operator\">=</span> <span class=\"token string\">\"\"</span><span class=\"token punctuation\">,</span> dataTypeClass <span class=\"token operator\">=</span> <span class=\"token class-name\">Void</span><span class=\"token punctuation\">.</span><span class=\"token keyword\">class</span><span class=\"token punctuation\">,</span> paramType <span class=\"token operator\">=</span> <span class=\"token string\">\"\"</span><span class=\"token punctuation\">,</span> example <span class=\"token operator\">=</span> <span class=\"token string\">\"\"</span><span class=\"token punctuation\">,</span> examples <span class=\"token operator\">=</span> <span class=\"token annotation punctuation\">@Example</span><span class=\"token punctuation\">(</span><span class=\"token punctuation\">&#123;</span><span class=\"token annotation punctuation\">@ExampleProperty</span><span class=\"token punctuation\">(</span></pre></td></tr><tr><td data-num=\"2\"></td><td><pre>            mediaType <span class=\"token operator\">=</span> <span class=\"token string\">\"\"</span><span class=\"token punctuation\">,</span></pre></td></tr><tr><td data-num=\"3\"></td><td><pre>            value <span class=\"token operator\">=</span> <span class=\"token string\">\"\"</span></pre></td></tr><tr><td data-num=\"4\"></td><td><pre>    <span class=\"token punctuation\">)</span><span class=\"token punctuation\">&#125;</span><span class=\"token punctuation\">)</span><span class=\"token punctuation\">,</span> type <span class=\"token operator\">=</span> <span class=\"token string\">\"\"</span><span class=\"token punctuation\">,</span> format <span class=\"token operator\">=</span> <span class=\"token string\">\"\"</span><span class=\"token punctuation\">,</span> allowEmptyValue <span class=\"token operator\">=</span> <span class=\"token boolean\">false</span><span class=\"token punctuation\">,</span> readOnly <span class=\"token operator\">=</span> <span class=\"token boolean\">false</span><span class=\"token punctuation\">,</span> collectionFormat <span class=\"token operator\">=</span> <span class=\"token string\">\"\"</span><span class=\"token punctuation\">)</span></pre></td></tr></table></figure><table>\n<thead>\n<tr>\n<th>属性名称</th>\n<th>说明</th>\n</tr>\n</thead>\n<tbody>\n<tr>\n<td>name</td>\n<td>参数名称 (实体类字段名称)</td>\n</tr>\n<tr>\n<td>value</td>\n<td>参数简要说明</td>\n</tr>\n<tr>\n<td>defaultValue</td>\n<td>描述参数的默认值</td>\n</tr>\n<tr>\n<td>allowableValues</td>\n<td>限制此参数接收的值，可使用的值或值得范围</td>\n</tr>\n<tr>\n<td>required</td>\n<td>指定是否为必填参数，false: 非必传参数；true: 必传参数</td>\n</tr>\n<tr>\n<td>access</td>\n<td>参数过滤，参考: io.swagger.core.filter.SwaggerSpecFilte</td>\n</tr>\n<tr>\n<td>allowMultiple</td>\n<td>指定参数是否可以通过多次出现来接收多个值</td>\n</tr>\n<tr>\n<td>dataType</td>\n<td>参数的数据类型，可以使类名或原始数据类型</td>\n</tr>\n<tr>\n<td>dataTypeClass</td>\n<td>参数的类，如果提供则覆盖 dataType</td>\n</tr>\n<tr>\n<td>paramType</td>\n<td>参数的参数类型，有效值为 path, query, body, header, form</td>\n</tr>\n<tr>\n<td>example</td>\n<td>非请求体 (body) 参数的单个请求示例</td>\n</tr>\n<tr>\n<td>examples</td>\n<td>参数示例，仅适用于 BodyParameters (请求体类型的)</td>\n</tr>\n<tr>\n<td>type</td>\n<td>添加覆盖检测到的类型的功能</td>\n</tr>\n<tr>\n<td>format</td>\n<td>添加提供自定义格式的功能</td>\n</tr>\n<tr>\n<td>allowEmptyValue</td>\n<td>添加将 format 设置为空的功能</td>\n</tr>\n<tr>\n<td>readOnly</td>\n<td>添加被指定为只读的能力</td>\n</tr>\n<tr>\n<td>collectionFormat</td>\n<td>添加使用 array 类型 collectionFormat 的功能</td>\n</tr>\n</tbody>\n</table>\n<h3 id=\"apiparam用于方法参数字段说明-表示对参数的要求和说明\"><a class=\"anchor\" href=\"#apiparam用于方法参数字段说明-表示对参数的要求和说明\">#</a> @ApiParam：用于方法，参数，字段说明 表示对参数的要求和说明</h3>\n<figure class=\"highlight java\"><figcaption data-lang=\"java\"></figcaption><table><tr><td data-num=\"1\"></td><td><pre><span class=\"token annotation punctuation\">@ApiParam</span><span class=\"token punctuation\">(</span>name <span class=\"token operator\">=</span> <span class=\"token string\">\"\"</span><span class=\"token punctuation\">,</span> value <span class=\"token operator\">=</span> <span class=\"token string\">\"\"</span><span class=\"token punctuation\">,</span> defaultValue <span class=\"token operator\">=</span> <span class=\"token string\">\"\"</span><span class=\"token punctuation\">,</span> allowableValues <span class=\"token operator\">=</span> <span class=\"token string\">\"\"</span><span class=\"token punctuation\">,</span> required <span class=\"token operator\">=</span> <span class=\"token boolean\">false</span><span class=\"token punctuation\">,</span> access <span class=\"token operator\">=</span> <span class=\"token string\">\"\"</span><span class=\"token punctuation\">,</span> allowMultiple <span class=\"token operator\">=</span> <span class=\"token boolean\">false</span><span class=\"token punctuation\">,</span> hidden <span class=\"token operator\">=</span> <span class=\"token boolean\">false</span><span class=\"token punctuation\">,</span> example <span class=\"token operator\">=</span> <span class=\"token string\">\"\"</span><span class=\"token punctuation\">,</span> examples <span class=\"token operator\">=</span> <span class=\"token annotation punctuation\">@Example</span><span class=\"token punctuation\">(</span><span class=\"token punctuation\">&#123;</span><span class=\"token annotation punctuation\">@ExampleProperty</span><span class=\"token punctuation\">(</span></pre></td></tr><tr><td data-num=\"2\"></td><td><pre>            mediaType <span class=\"token operator\">=</span> <span class=\"token string\">\"\"</span><span class=\"token punctuation\">,</span></pre></td></tr><tr><td data-num=\"3\"></td><td><pre>            value <span class=\"token operator\">=</span> <span class=\"token string\">\"\"</span></pre></td></tr><tr><td data-num=\"4\"></td><td><pre>    <span class=\"token punctuation\">)</span><span class=\"token punctuation\">&#125;</span><span class=\"token punctuation\">)</span><span class=\"token punctuation\">,</span> type <span class=\"token operator\">=</span> <span class=\"token string\">\"\"</span><span class=\"token punctuation\">,</span> format <span class=\"token operator\">=</span> <span class=\"token string\">\"\"</span><span class=\"token punctuation\">,</span> allowEmptyValue <span class=\"token operator\">=</span> <span class=\"token boolean\">false</span><span class=\"token punctuation\">,</span> readOnly <span class=\"token operator\">=</span> <span class=\"token boolean\">false</span><span class=\"token punctuation\">,</span> collectionFormat <span class=\"token operator\">=</span> <span class=\"token string\">\"\"</span><span class=\"token punctuation\">)</span></pre></td></tr></table></figure><table>\n<thead>\n<tr>\n<th>属性名称</th>\n<th>说明</th>\n</tr>\n</thead>\n<tbody>\n<tr>\n<td>name</td>\n<td>参数名称，参数名称将从 filed/method/parameter 名称中派生，但你可以覆盖它，路径参数必须始终命名为它们所代表的路径部分</td>\n</tr>\n<tr>\n<td>value</td>\n<td>参数简单描述</td>\n</tr>\n<tr>\n<td>defaultValue</td>\n<td>描述参数默认值</td>\n</tr>\n<tr>\n<td>allowableValues</td>\n<td>可接收参数值限制，有三种方式，取值列表，取值范围</td>\n</tr>\n<tr>\n<td>required</td>\n<td>是否为必传参数，false: 非必传；true: 必传</td>\n</tr>\n<tr>\n<td>access</td>\n<td>参数过滤，请参阅:io.swagger.core.filter.SwaggerSpecFilter</td>\n</tr>\n<tr>\n<td>allowMultiple</td>\n<td>指定参数是否可以通过多次出现来接收多个值</td>\n</tr>\n<tr>\n<td>hidden</td>\n<td>隐藏参数列表中的参数</td>\n</tr>\n<tr>\n<td>example</td>\n<td>非请求体 (body) 类型的单个参数示例</td>\n</tr>\n<tr>\n<td>examples</td>\n<td>参数示例，仅适用于请求体类型的请求</td>\n</tr>\n<tr>\n<td>type</td>\n<td>添加覆盖检测到的类型的功能</td>\n</tr>\n<tr>\n<td>format</td>\n<td>添加提供自定义 format 格式的功能</td>\n</tr>\n<tr>\n<td>allowEmptyValue</td>\n<td>添加将格式设置为空的功能</td>\n</tr>\n<tr>\n<td>readOnly</td>\n<td>添加被指定为只读的能力</td>\n</tr>\n<tr>\n<td>collectionFormat</td>\n<td>添加使用 array 类型 collectionFormat 的功能</td>\n</tr>\n</tbody>\n</table>\n<h2 id=\"apimodel用于响应实体类上用于说明实体作用\"><a class=\"anchor\" href=\"#apimodel用于响应实体类上用于说明实体作用\">#</a> @ApiModel：用于响应实体类上，用于说明实体作用</h2>\n<figure class=\"highlight java\"><figcaption data-lang=\"java\"></figcaption><table><tr><td data-num=\"1\"></td><td><pre><span class=\"token annotation punctuation\">@ApiModel</span><span class=\"token punctuation\">(</span>value <span class=\"token operator\">=</span> <span class=\"token string\">\"\"</span><span class=\"token punctuation\">,</span> description <span class=\"token operator\">=</span> <span class=\"token string\">\"\"</span><span class=\"token punctuation\">,</span> parent <span class=\"token operator\">=</span> <span class=\"token class-name\">Void</span><span class=\"token punctuation\">.</span><span class=\"token keyword\">class</span><span class=\"token punctuation\">,</span> discriminator <span class=\"token operator\">=</span> <span class=\"token string\">\"\"</span><span class=\"token punctuation\">,</span> subTypes <span class=\"token operator\">=</span> <span class=\"token punctuation\">&#123;</span><span class=\"token punctuation\">&#125;</span><span class=\"token punctuation\">,</span> reference <span class=\"token operator\">=</span> <span class=\"token string\">\"\"</span><span class=\"token punctuation\">)</span></pre></td></tr></table></figure><table>\n<thead>\n<tr>\n<th>属性名称</th>\n<th>说明</th>\n</tr>\n</thead>\n<tbody>\n<tr>\n<td>value</td>\n<td>为模型提供备用名称</td>\n</tr>\n<tr>\n<td>description</td>\n<td>提供详细的类描述</td>\n</tr>\n<tr>\n<td>parent</td>\n<td>为模型提供父类以允许描述继承关系</td>\n</tr>\n<tr>\n<td>discriminator</td>\n<td>支持模型继承和多态，使用鉴别器的字段的名称，可以断言需要使用哪个子类型</td>\n</tr>\n<tr>\n<td>subTypes</td>\n<td>从此模型继承的子类型数组</td>\n</tr>\n<tr>\n<td>reference</td>\n<td>指定对应类型定义的引用，覆盖指定的任何其他元数据</td>\n</tr>\n</tbody>\n</table>\n<h3 id=\"apimodelproperty用在属性上描述实体类的属性\"><a class=\"anchor\" href=\"#apimodelproperty用在属性上描述实体类的属性\">#</a> @ApiModelProperty：用在属性上，描述实体类的属性</h3>\n<figure class=\"highlight java\"><figcaption data-lang=\"java\"></figcaption><table><tr><td data-num=\"1\"></td><td><pre><span class=\"token annotation punctuation\">@ApiModelProperty</span><span class=\"token punctuation\">(</span>value <span class=\"token operator\">=</span> <span class=\"token string\">\"\"</span><span class=\"token punctuation\">,</span> name <span class=\"token operator\">=</span> <span class=\"token string\">\"\"</span><span class=\"token punctuation\">,</span> allowableValues <span class=\"token operator\">=</span> <span class=\"token string\">\"\"</span><span class=\"token punctuation\">,</span> access <span class=\"token operator\">=</span> <span class=\"token string\">\"\"</span><span class=\"token punctuation\">,</span> notes <span class=\"token operator\">=</span> <span class=\"token string\">\"\"</span><span class=\"token punctuation\">,</span> dataType <span class=\"token operator\">=</span> <span class=\"token string\">\"\"</span><span class=\"token punctuation\">,</span> required <span class=\"token operator\">=</span> <span class=\"token boolean\">false</span><span class=\"token punctuation\">,</span> position <span class=\"token operator\">=</span> <span class=\"token number\">0</span><span class=\"token punctuation\">,</span> hidden <span class=\"token operator\">=</span> <span class=\"token boolean\">false</span><span class=\"token punctuation\">,</span> example <span class=\"token operator\">=</span> <span class=\"token string\">\"\"</span><span class=\"token punctuation\">,</span> accessMode <span class=\"token operator\">=</span> <span class=\"token class-name\">ApiModelProperty<span class=\"token punctuation\">.</span>AccessMode</span><span class=\"token punctuation\">.</span>AUTO<span class=\"token punctuation\">,</span> reference <span class=\"token operator\">=</span> <span class=\"token string\">\"\"</span><span class=\"token punctuation\">,</span> allowEmptyValue <span class=\"token operator\">=</span> <span class=\"token boolean\">false</span><span class=\"token punctuation\">,</span> extensions <span class=\"token operator\">=</span> <span class=\"token punctuation\">&#123;</span><span class=\"token annotation punctuation\">@Extension</span><span class=\"token punctuation\">(</span></pre></td></tr><tr><td data-num=\"2\"></td><td><pre>            properties <span class=\"token operator\">=</span> <span class=\"token punctuation\">&#123;</span><span class=\"token annotation punctuation\">@ExtensionProperty</span><span class=\"token punctuation\">(</span></pre></td></tr><tr><td data-num=\"3\"></td><td><pre>                    name <span class=\"token operator\">=</span> <span class=\"token string\">\"\"</span><span class=\"token punctuation\">,</span></pre></td></tr><tr><td data-num=\"4\"></td><td><pre>                    value <span class=\"token operator\">=</span> <span class=\"token string\">\"\"</span></pre></td></tr><tr><td data-num=\"5\"></td><td><pre>            <span class=\"token punctuation\">)</span><span class=\"token punctuation\">&#125;</span></pre></td></tr><tr><td data-num=\"6\"></td><td><pre>    <span class=\"token punctuation\">)</span><span class=\"token punctuation\">&#125;</span><span class=\"token punctuation\">)</span></pre></td></tr></table></figure><table>\n<thead>\n<tr>\n<th>属性名称</th>\n<th>说明</th>\n</tr>\n</thead>\n<tbody>\n<tr>\n<td>value</td>\n<td>属性简要说明</td>\n</tr>\n<tr>\n<td>name</td>\n<td>运行覆盖属性的名称。重写属性名称</td>\n</tr>\n<tr>\n<td>allowableValues</td>\n<td>限制参数可接收的值，三种方法，固定取值，固定范围</td>\n</tr>\n<tr>\n<td>access</td>\n<td>过滤属性，参阅:io.swagger.core.filter.SwaggerSpecFilter</td>\n</tr>\n<tr>\n<td>notes</td>\n<td>目前尚未使用</td>\n</tr>\n<tr>\n<td>dataType</td>\n<td>参数的数据类型，可以是类名或原始数据类型，此值将覆盖从类属性读取的数据类型</td>\n</tr>\n<tr>\n<td>required</td>\n<td>是否为必传参数，false: 非必传参数；true: 必传参数</td>\n</tr>\n<tr>\n<td>position</td>\n<td>允许在模型中显示排序属性</td>\n</tr>\n<tr>\n<td>hidden</td>\n<td>隐藏模型属性，false: 不隐藏；true: 隐藏</td>\n</tr>\n<tr>\n<td>example</td>\n<td>属性的示例值</td>\n</tr>\n<tr>\n<td>accessMode</td>\n<td></td>\n</tr>\n<tr>\n<td>reference</td>\n<td>指定对应类型定义的引用，覆盖指定的任何其他元数据</td>\n</tr>\n<tr>\n<td>allowEmptyValue</td>\n<td>允许传空值，false: 不允许传空值；true: 允许传空值</td>\n</tr>\n<tr>\n<td>extensions</td>\n<td></td>\n</tr>\n</tbody>\n</table>\n<h2 id=\"apiresponses用于请求的方法上根据响应码表示不同响应包含多个-apiresponse\"><a class=\"anchor\" href=\"#apiresponses用于请求的方法上根据响应码表示不同响应包含多个-apiresponse\">#</a> @ApiResponses：用于请求的方法上，根据响应码表示不同响应，包含多个 @ApiResponse</h2>\n<figure class=\"highlight java\"><figcaption data-lang=\"java\"></figcaption><table><tr><td data-num=\"1\"></td><td><pre><span class=\"token annotation punctuation\">@ApiResponses</span><span class=\"token punctuation\">(</span>value <span class=\"token operator\">=</span> <span class=\"token punctuation\">&#123;</span><span class=\"token punctuation\">&#125;</span><span class=\"token punctuation\">)</span></pre></td></tr></table></figure><table>\n<thead>\n<tr>\n<th>属性名称</th>\n<th>说明</th>\n</tr>\n</thead>\n<tbody>\n<tr>\n<td>value</td>\n<td>ApiResponse 列表</td>\n</tr>\n</tbody>\n</table>\n<h3 id=\"apiresponse用在请求的方法上表示不同的响应\"><a class=\"anchor\" href=\"#apiresponse用在请求的方法上表示不同的响应\">#</a> @ApiResponse：用在请求的方法上，表示不同的响应</h3>\n<figure class=\"highlight java\"><figcaption data-lang=\"java\"></figcaption><table><tr><td data-num=\"1\"></td><td><pre><span class=\"token annotation punctuation\">@ApiResponse</span><span class=\"token punctuation\">(</span>code <span class=\"token operator\">=</span> <span class=\"token number\">200</span><span class=\"token punctuation\">,</span> message <span class=\"token operator\">=</span> <span class=\"token string\">\"\"</span><span class=\"token punctuation\">,</span> response <span class=\"token operator\">=</span> <span class=\"token class-name\">Void</span><span class=\"token punctuation\">.</span><span class=\"token keyword\">class</span><span class=\"token punctuation\">,</span> reference <span class=\"token operator\">=</span> <span class=\"token string\">\"\"</span><span class=\"token punctuation\">,</span> responseHeaders <span class=\"token operator\">=</span> <span class=\"token punctuation\">&#123;</span><span class=\"token annotation punctuation\">@ResponseHeader</span><span class=\"token punctuation\">(</span></pre></td></tr><tr><td data-num=\"2\"></td><td><pre>            name <span class=\"token operator\">=</span> <span class=\"token string\">\"\"</span><span class=\"token punctuation\">,</span></pre></td></tr><tr><td data-num=\"3\"></td><td><pre>            response <span class=\"token operator\">=</span> <span class=\"token class-name\">Void</span><span class=\"token punctuation\">.</span><span class=\"token keyword\">class</span></pre></td></tr><tr><td data-num=\"4\"></td><td><pre>    <span class=\"token punctuation\">)</span><span class=\"token punctuation\">&#125;</span><span class=\"token punctuation\">,</span> responseContainer <span class=\"token operator\">=</span> <span class=\"token string\">\"\"</span><span class=\"token punctuation\">,</span> examples <span class=\"token operator\">=</span> <span class=\"token annotation punctuation\">@Example</span><span class=\"token punctuation\">(</span><span class=\"token punctuation\">&#123;</span><span class=\"token annotation punctuation\">@ExampleProperty</span><span class=\"token punctuation\">(</span></pre></td></tr><tr><td data-num=\"5\"></td><td><pre>            value <span class=\"token operator\">=</span> <span class=\"token string\">\"\"</span><span class=\"token punctuation\">,</span></pre></td></tr><tr><td data-num=\"6\"></td><td><pre>            mediaType <span class=\"token operator\">=</span> <span class=\"token string\">\"\"</span></pre></td></tr><tr><td data-num=\"7\"></td><td><pre>    <span class=\"token punctuation\">)</span><span class=\"token punctuation\">&#125;</span><span class=\"token punctuation\">)</span><span class=\"token punctuation\">)</span></pre></td></tr></table></figure><table>\n<thead>\n<tr>\n<th>属性名称</th>\n<th>说明</th>\n</tr>\n</thead>\n<tbody>\n<tr>\n<td>code</td>\n<td>响应的 HTTP 状态码</td>\n</tr>\n<tr>\n<td>message</td>\n<td>伴随响应的人类可读的消息</td>\n</tr>\n<tr>\n<td>response</td>\n<td>用于描述消息有效负载的可选响应类，对应于响应消息对象的 schema 字段</td>\n</tr>\n<tr>\n<td>reference</td>\n<td>指定对响应类型的引用，指定的应用可以使本地引用，也可以是远程引用，将按原样使用，并将覆盖任何指定的 response () 类</td>\n</tr>\n<tr>\n<td>responseHeaders</td>\n<td>可能响应的 header 列表</td>\n</tr>\n<tr>\n<td>responseContainer</td>\n<td>声明响应的容器，有效值为 List,Set,Map，任何其他值都将被忽略</td>\n</tr>\n<tr>\n<td>examples</td>\n<td></td>\n</tr>\n</tbody>\n</table>\n<h2 id=\"apiignore用于类或者方法上不被显示在页面上\"><a class=\"anchor\" href=\"#apiignore用于类或者方法上不被显示在页面上\">#</a> @ApiIgnore ()：用于类或者方法上，不被显示在页面上</h2>\n<h2 id=\"profiledev-test用于配置类上表示只对开发和测试环境有用\"><a class=\"anchor\" href=\"#profiledev-test用于配置类上表示只对开发和测试环境有用\">#</a> @Profile ({&quot;dev&quot;, &quot;test&quot;})：用于配置类上，表示只对开发和测试环境有用</h2>\n",
            "tags": [
                "SpringBoot",
                "接口文档",
                "Java"
            ]
        },
        {
            "id": "https://dreamdivination.gitee.io/2022/03/31/Consul/",
            "url": "https://dreamdivination.gitee.io/2022/03/31/Consul/",
            "title": "Consul",
            "date_published": "2022-03-30T16:00:00.000Z",
            "content_html": "<h1 id=\"简介\"><a class=\"anchor\" href=\"#简介\">#</a> 简介</h1>\n<h2 id=\"概念\"><a class=\"anchor\" href=\"#概念\">#</a> 概念</h2>\n<blockquote>\n<p><span class=\"exturl\" data-url=\"aHR0cHM6Ly93d3cuY29uc3VsLmlvLw==\">Consul</span> 是 HashiCorp 公司推出的开源工具，Consul 由 Go 语言开发。<br />\n提供了微服务系统中的服务治理、配置中心、控制总线等功能。这些功能的每一个都可以根据需要单独使用，也可以一起使用以构建全方位的服务网格，<strong>Consul</strong> 提供了一种完整的服务网格解决方案。</p>\n</blockquote>\n<blockquote>\n<p>优点：</p>\n<ol>\n<li>基于 <span class=\"exturl\" data-url=\"aHR0cHM6Ly96aC53aWtpcGVkaWEub3JnL3poL1JhZnQ=\">raft</span> 协议，比较简洁</li>\n<li>支持健康检查，同时支持 <span class=\"exturl\" data-url=\"aHR0cHM6Ly96aC53aWtpcGVkaWEub3JnL3dpa2kvJUU4JUI2JTg1JUU2JTk2JTg3JUU2JTlDJUFDJUU0JUJDJUEwJUU4JUJFJTkzJUU1JThEJThGJUU4JUFFJUFF\">HTTP</span> 和 <span class=\"exturl\" data-url=\"aHR0cHM6Ly96aC53aWtpcGVkaWEub3JnL3dpa2kvJUU1JTlGJTlGJUU1JTkwJThEJUU3JUIzJUJCJUU3JUJCJTlG\">DNS</span> 协议，支持跨数据中心的 <span class=\"exturl\" data-url=\"aHR0cHM6Ly96aC53aWtpcGVkaWEub3JnL3dpa2kvJUU1JUI5JUJGJUU1JTlGJTlGJUU3JUJEJTkx\">WAN</span> 集群，提供 <span class=\"exturl\" data-url=\"aHR0cHM6Ly96aC53aWtpcGVkaWEub3JnL3dpa2kvJUU0JUI4JTg3JUU3JUJCJUI0JUU3JUJEJTkx\">Web</span> 图形界面</li>\n<li>跨平台，支持 Linux、Mac、Windows</li>\n</ol>\n</blockquote>\n<h2 id=\"特性\"><a class=\"anchor\" href=\"#特性\">#</a> 特性</h2>\n<ol>\n<li>服务发现（Service Discovery）：Consul 提供了通过 DNS 或者 HTTP 接口的方式来注册服务和发现服务。一些外部的服务通过 Consul 很容易的找到它所依赖的服务</li>\n<li>健康检查（Health Checking）：Consul 的 Client 可以提供任意数量的健康检查，既可以与给定的服务相关联 (“webserver 是否返回 200 OK”)，也可以与本地节点相关联 (“内存利用率是否低于 90%”)。操作员可以使用这些信息来监视集群的健康状况，服务发现组件可以使用这些信息将流量从不健康的主机路由出去</li>\n<li>Key/Value 存储：应用程序可以根据自己的需要使用 Consul 提供的 Key/Value 存储。 Consul 提供了简单易用的 HTTP 接口，结合其他工具可以实现动态配置、功能标记、领袖选举等等功能</li>\n<li>安全服务通信：Consul 可以为服务生成和分发 TLS 证书，以建立相互的 TLS 连接。意图可用于定义允许哪些服务通信。服务分割可以很容易地进行管理，其目的是可以实时更改的，而不是使用复杂的网络拓扑和静态防火墙规则</li>\n<li>多数据中心：Consul 支持开箱即用的多数据中心。这意味着用户不需要担心需要建立额外的抽象层让业务扩展到多个区域</li>\n</ol>\n<h1 id=\"安装并运行\"><a class=\"anchor\" href=\"#安装并运行\">#</a> 安装并运行</h1>\n<blockquote>\n<p><span class=\"exturl\" data-url=\"aHR0cHM6Ly9sZWFybi5oYXNoaWNvcnAuY29tL3R1dG9yaWFscy9jb25zdWwvZ2V0LXN0YXJ0ZWQtaW5zdGFsbA==\">安装教程</span></p>\n</blockquote>\n<h2 id=\"使用开发模式启动\"><a class=\"anchor\" href=\"#使用开发模式启动\">#</a> 使用开发模式启动</h2>\n<blockquote>\n<p>命令</p>\n</blockquote>\n<figure class=\"highlight shell\"><figcaption data-lang=\"Bash\"></figcaption><table><tr><td data-num=\"1\"></td><td><pre>consul agent -dev</pre></td></tr></table></figure><blockquote>\n<p><span class=\"exturl\" data-url=\"aHR0cDovL2xvY2FsaG9zdDo4NTAwL3VpLw==\">Web 图形界面</span></p>\n</blockquote>\n<h1 id=\"spring-cloud\"><a class=\"anchor\" href=\"#spring-cloud\">#</a> Spring Cloud</h1>\n<h2 id=\"依赖\"><a class=\"anchor\" href=\"#依赖\">#</a> 依赖</h2>\n<figure class=\"highlight xml\"><figcaption data-lang=\"XML\"></figcaption><table><tr><td data-num=\"1\"></td><td><pre><span class=\"token tag\"><span class=\"token tag\"><span class=\"token punctuation\">&lt;</span>dependency</span><span class=\"token punctuation\">></span></span></pre></td></tr><tr><td data-num=\"2\"></td><td><pre>            <span class=\"token tag\"><span class=\"token tag\"><span class=\"token punctuation\">&lt;</span>groupId</span><span class=\"token punctuation\">></span></span>org.springframework.cloud<span class=\"token tag\"><span class=\"token tag\"><span class=\"token punctuation\">&lt;/</span>groupId</span><span class=\"token punctuation\">></span></span></pre></td></tr><tr><td data-num=\"3\"></td><td><pre>            <span class=\"token tag\"><span class=\"token tag\"><span class=\"token punctuation\">&lt;</span>artifactId</span><span class=\"token punctuation\">></span></span>spring-cloud-starter-consul-discovery<span class=\"token tag\"><span class=\"token tag\"><span class=\"token punctuation\">&lt;/</span>artifactId</span><span class=\"token punctuation\">></span></span></pre></td></tr><tr><td data-num=\"4\"></td><td><pre>        <span class=\"token tag\"><span class=\"token tag\"><span class=\"token punctuation\">&lt;/</span>dependency</span><span class=\"token punctuation\">></span></span></pre></td></tr></table></figure><h2 id=\"配置文件\"><a class=\"anchor\" href=\"#配置文件\">#</a> 配置文件</h2>\n<figure class=\"highlight yml\"><figcaption data-lang=\"YAML\"></figcaption><table><tr><td data-num=\"1\"></td><td><pre><span class=\"token key atrule\">spring</span><span class=\"token punctuation\">:</span></pre></td></tr><tr><td data-num=\"2\"></td><td><pre>  <span class=\"token key atrule\">application</span><span class=\"token punctuation\">:</span></pre></td></tr><tr><td data-num=\"3\"></td><td><pre>    <span class=\"token key atrule\">name</span><span class=\"token punctuation\">:</span> consul<span class=\"token punctuation\">-</span>server<span class=\"token punctuation\">-</span>name</pre></td></tr><tr><td data-num=\"4\"></td><td><pre>  <span class=\"token key atrule\">cloud</span><span class=\"token punctuation\">:</span></pre></td></tr><tr><td data-num=\"5\"></td><td><pre>    <span class=\"token key atrule\">consul</span><span class=\"token punctuation\">:</span></pre></td></tr><tr><td data-num=\"6\"></td><td><pre>      <span class=\"token key atrule\">host</span><span class=\"token punctuation\">:</span> localhost</pre></td></tr><tr><td data-num=\"7\"></td><td><pre>      <span class=\"token key atrule\">port</span><span class=\"token punctuation\">:</span> <span class=\"token number\">8500</span></pre></td></tr><tr><td data-num=\"8\"></td><td><pre>      <span class=\"token key atrule\">discovery</span><span class=\"token punctuation\">:</span></pre></td></tr><tr><td data-num=\"9\"></td><td><pre>        <span class=\"token comment\"># hostname: 127.0.0.1</span></pre></td></tr><tr><td data-num=\"10\"></td><td><pre>        <span class=\"token key atrule\">service-name</span><span class=\"token punctuation\">:</span> $<span class=\"token punctuation\">&#123;</span>spring.application.name<span class=\"token punctuation\">&#125;</span></pre></td></tr></table></figure><h2 id=\"启动类注解\"><a class=\"anchor\" href=\"#启动类注解\">#</a> 启动类注解</h2>\n<figure class=\"highlight java\"><figcaption data-lang=\"java\"></figcaption><table><tr><td data-num=\"1\"></td><td><pre><span class=\"token annotation punctuation\">@EnableDiscoveryClient</span></pre></td></tr></table></figure><h2 id=\"服务调用\"><a class=\"anchor\" href=\"#服务调用\">#</a> 服务调用</h2>\n<h3 id=\"resttemplate-配置\"><a class=\"anchor\" href=\"#resttemplate-配置\">#</a> RestTemplate 配置</h3>\n<figure class=\"highlight java\"><figcaption data-lang=\"java\"></figcaption><table><tr><td data-num=\"1\"></td><td><pre><span class=\"token annotation punctuation\">@Configuration</span></pre></td></tr><tr><td data-num=\"2\"></td><td><pre><span class=\"token keyword\">public</span> <span class=\"token keyword\">class</span> <span class=\"token class-name\">ApplicationContextConfig</span> <span class=\"token punctuation\">&#123;</span></pre></td></tr><tr><td data-num=\"3\"></td><td><pre></pre></td></tr><tr><td data-num=\"4\"></td><td><pre>    <span class=\"token annotation punctuation\">@Bean</span></pre></td></tr><tr><td data-num=\"5\"></td><td><pre>    <span class=\"token comment\">// 赋予负载均衡能力</span></pre></td></tr><tr><td data-num=\"6\"></td><td><pre>    <span class=\"token annotation punctuation\">@LoadBalanced</span></pre></td></tr><tr><td data-num=\"7\"></td><td><pre>    <span class=\"token keyword\">public</span> <span class=\"token class-name\">RestTemplate</span> <span class=\"token function\">getRest</span><span class=\"token punctuation\">(</span><span class=\"token punctuation\">)</span> <span class=\"token punctuation\">&#123;</span></pre></td></tr><tr><td data-num=\"8\"></td><td><pre>        <span class=\"token keyword\">return</span> <span class=\"token keyword\">new</span> <span class=\"token class-name\">RestTemplate</span><span class=\"token punctuation\">(</span><span class=\"token punctuation\">)</span><span class=\"token punctuation\">;</span></pre></td></tr><tr><td data-num=\"9\"></td><td><pre>    <span class=\"token punctuation\">&#125;</span></pre></td></tr><tr><td data-num=\"10\"></td><td><pre><span class=\"token punctuation\">&#125;</span></pre></td></tr></table></figure><blockquote>\n<p>将同一注册中心的服务，通过<strong> RestTemplate</strong> 对 <span class=\"exturl\" data-url=\"aHR0cDovL2NvbnN1bC1zZXJ2ZXItbmFtZS8q\">http://consul-server-name/*</span> 进行请求</p>\n</blockquote>\n",
            "tags": [
                "Spring Cloud",
                "注册中心",
                "微服务",
                "Java"
            ]
        },
        {
            "id": "https://dreamdivination.gitee.io/2022/03/30/Chocolatey/",
            "url": "https://dreamdivination.gitee.io/2022/03/30/Chocolatey/",
            "title": "Chocolatey",
            "date_published": "2022-03-29T16:00:00.000Z",
            "content_html": "<h1 id=\"前言\"><a class=\"anchor\" href=\"#前言\">#</a> 前言</h1>\n<p>Chocolatey 是一款专为 Windows 系统开发的、基于 NuGet 的包管理器工具，类似于 Node.js 的 npm，MacOS 的 brew，Ubuntu 的 apt-get，它简称为 choco。Chocolatey 的设计目标是成为一个去中心化的框架，便于开发者按需快速安装应用程序和工具。</p>\n<p>Chocolatey 的官网： <span class=\"exturl\" data-url=\"aHR0cHM6Ly9jaG9jb2xhdGV5Lm9yZy8=\">https://chocolatey.org/</span></p>\n<h1 id=\"安装\"><a class=\"anchor\" href=\"#安装\">#</a> 安装</h1>\n<h2 id=\"command-prompt\"><a class=\"anchor\" href=\"#command-prompt\">#</a> Command Prompt</h2>\n<figure class=\"highlight shell\"><figcaption data-lang=\"Bash\"></figcaption><table><tr><td data-num=\"1\"></td><td><pre>@<span class=\"token string\">\"%SystemRoot%\\System32\\WindowsPowerShell<span class=\"token entity\" title=\"\\v\">\\v</span>1.0\\powershell.exe\"</span> -NoProfile -InputFormat None -ExecutionPolicy Bypass -Command <span class=\"token string\">\"iex <span class=\"token variable\"><span class=\"token punctuation\">((</span>New<span class=\"token operator\">-</span>Object System.Net.WebClient<span class=\"token punctuation\">)</span>.DownloadString<span class=\"token punctuation\">(</span>'https<span class=\"token operator\">:</span><span class=\"token operator\">/</span><span class=\"token operator\">/</span>chocolatey.org<span class=\"token operator\">/</span>install.ps1'<span class=\"token punctuation\">))</span></span>\"</span> <span class=\"token operator\">&amp;&amp;</span> SET <span class=\"token string\">\"PATH=%PATH%;%ALLUSERSPROFILE%<span class=\"token entity\" title=\"\\c\">\\c</span>hocolatey<span class=\"token entity\" title=\"\\b\">\\b</span>in\"</span></pre></td></tr></table></figure><h2 id=\"powershell\"><a class=\"anchor\" href=\"#powershell\">#</a> PowerShell</h2>\n<figure class=\"highlight shell\"><figcaption data-lang=\"Bash\"></figcaption><table><tr><td data-num=\"1\"></td><td><pre>Set-ExecutionPolicy Bypass -Scope Process -Force<span class=\"token punctuation\">;</span> <span class=\"token punctuation\">[</span>System.Net.ServicePointManager<span class=\"token punctuation\">]</span>::SecurityProtocol <span class=\"token operator\">=</span> <span class=\"token punctuation\">[</span>System.Net.ServicePointManager<span class=\"token punctuation\">]</span>::SecurityProtocol -bor <span class=\"token number\">3072</span><span class=\"token punctuation\">;</span> iex <span class=\"token variable\"><span class=\"token punctuation\">((</span>New<span class=\"token operator\">-</span>Object System.Net.WebClient<span class=\"token punctuation\">)</span>.DownloadString<span class=\"token punctuation\">(</span>'https<span class=\"token operator\">:</span><span class=\"token operator\">/</span><span class=\"token operator\">/</span>community.chocolatey.org<span class=\"token operator\">/</span>install.ps1'<span class=\"token punctuation\">))</span></span></pre></td></tr></table></figure><blockquote>\n<p>必须以<strong>管理员</strong>权限打开<strong> Command Prompt</strong> 或<strong> PowerShell</strong></p>\n</blockquote>\n<h2 id=\"检测安装是否成功\"><a class=\"anchor\" href=\"#检测安装是否成功\">#</a> 检测安装是否成功</h2>\n<blockquote>\n<p>在终端执行<strong> choco</strong> 或者 **choco -?** 检测是否安装成功</p>\n</blockquote>\n<h1 id=\"用法\"><a class=\"anchor\" href=\"#用法\">#</a> 用法</h1>\n<h2 id=\"基本命令\"><a class=\"anchor\" href=\"#基本命令\">#</a> 基本命令</h2>\n<figure class=\"highlight shell\"><figcaption data-lang=\"Bash\"></figcaption><table><tr><td data-num=\"1\"></td><td><pre>choco search <span class=\"token operator\">&lt;</span>keyword<span class=\"token operator\">></span>  <span class=\"token comment\"># 搜索 &lt;keyword> 包</span></pre></td></tr><tr><td data-num=\"2\"></td><td><pre>choco list <span class=\"token operator\">&lt;</span>keyword<span class=\"token operator\">></span>    <span class=\"token comment\"># 列出 &lt;keyword> 包</span></pre></td></tr><tr><td data-num=\"3\"></td><td><pre>choco <span class=\"token function\">install</span> <span class=\"token operator\">&lt;</span>package1 package2 <span class=\"token punctuation\">..</span>.<span class=\"token operator\">></span>   <span class=\"token comment\"># 安装 &lt;package1,package2 ...> 包</span></pre></td></tr><tr><td data-num=\"4\"></td><td><pre>choco <span class=\"token function\">install</span> <span class=\"token operator\">&lt;</span>package<span class=\"token operator\">></span>  -version ***   <span class=\"token comment\"># 安装 &lt;package> 的指定版本</span></pre></td></tr><tr><td data-num=\"5\"></td><td><pre>choco uninstall <span class=\"token operator\">&lt;</span>package<span class=\"token operator\">></span>   <span class=\"token comment\"># 卸载 &lt;package> 包</span></pre></td></tr><tr><td data-num=\"6\"></td><td><pre>choco version <span class=\"token operator\">&lt;</span>package<span class=\"token operator\">></span> <span class=\"token comment\"># 查看 &lt;package> 包的版本情况</span></pre></td></tr><tr><td data-num=\"7\"></td><td><pre>choco upgrade <span class=\"token operator\">&lt;</span>package<span class=\"token operator\">></span>    <span class=\"token comment\"># 更新 &lt;package> 包</span></pre></td></tr><tr><td data-num=\"8\"></td><td><pre>choco pin <span class=\"token operator\">&lt;</span>package<span class=\"token operator\">></span>  <span class=\"token comment\"># 固定 &lt;package> 包的版本，防止被升级</span></pre></td></tr></table></figure><h2 id=\"常用命令命令\"><a class=\"anchor\" href=\"#常用命令命令\">#</a> 常用命令命令</h2>\n<blockquote>\n<p>列出本地已安装的包</p>\n</blockquote>\n<figure class=\"highlight shell\"><figcaption data-lang=\"Bash\"></figcaption><table><tr><td data-num=\"1\"></td><td><pre>choco list -local-only</pre></td></tr><tr><td data-num=\"2\"></td><td><pre><span class=\"token comment\"># 或</span></pre></td></tr><tr><td data-num=\"3\"></td><td><pre>choco list -lo</pre></td></tr></table></figure><blockquote>\n<p>列出 Windows 系统已安装的软件</p>\n</blockquote>\n<figure class=\"highlight shell\"><figcaption data-lang=\"Bash\"></figcaption><table><tr><td data-num=\"1\"></td><td><pre>choco list -li</pre></td></tr><tr><td data-num=\"2\"></td><td><pre><span class=\"token comment\"># 或</span></pre></td></tr><tr><td data-num=\"3\"></td><td><pre>choco list -lai</pre></td></tr></table></figure><blockquote>\n<p>升级所有已安装的包</p>\n</blockquote>\n<figure class=\"highlight shell\"><figcaption data-lang=\"Bash\"></figcaption><table><tr><td data-num=\"1\"></td><td><pre>choco upgrade all -y</pre></td></tr></table></figure><h2 id=\"包类型简介\"><a class=\"anchor\" href=\"#包类型简介\">#</a> 包类型简介</h2>\n<p>Chocolatey 的包有不同的类型，有些包的名字里面会包含特殊的后缀，比如 .install ，.commandline，.portable ，有些包的名字不带这些后缀。</p>\n<ul>\n<li>无后缀（例：nodejs，git）</li>\n<li>.install （例：nodejs.install，git.install）</li>\n<li>.install 后缀的包，这个包会出现在系统控制面板里的 卸载或更改程序 里面，你可以把 .install 的包想成是通过安装程序（msi）安装的包。</li>\n<li>.commandline（例：nodejs.commandline，未来会被抛弃）</li>\n<li>.commandline（未来会被抛弃） 与 .portable 后缀的包是压缩包（zip），安装这种后缀的包，你不能在 卸载或更改程序 里找到它们。</li>\n<li>.portable （例：putty.portable）</li>\n</ul>\n<p>你也可以选择不带后缀的包，这样如果系统中已经安装了这个包，就会跳过去，如果没安装，Chocolatey 就会为你安装一个，默认安装的这个包的类型应该就是 .install 后缀的包。</p>\n<blockquote>\n<p>软件包的推荐顺序： 无后缀 &gt; .install &gt; .portable &gt; .commandline</p>\n</blockquote>\n",
            "tags": [
                "包管理器",
                "Win"
            ]
        },
        {
            "id": "https://dreamdivination.gitee.io/2022/03/30/Zookeeper/",
            "url": "https://dreamdivination.gitee.io/2022/03/30/Zookeeper/",
            "title": "Zookeeper",
            "date_published": "2022-03-29T16:00:00.000Z",
            "content_html": "<h1 id=\"安装\"><a class=\"anchor\" href=\"#安装\">#</a> 安装</h1>\n<h2 id=\"zookeeper\"><a class=\"anchor\" href=\"#zookeeper\">#</a> Zookeeper</h2>\n<blockquote>\n<p>网站：<span class=\"exturl\" data-url=\"aHR0cHM6Ly9hcmNoaXZlLmFwYWNoZS5vcmcvZGlzdC96b29rZWVwZXI=\">https://archive.apache.org/dist/zookeeper</span></p>\n</blockquote>\n<figure class=\"highlight shell\"><figcaption data-lang=\"Bash\"></figcaption><table><tr><td data-num=\"1\"></td><td><pre><span class=\"token comment\"># 将 version 为 3.4.9 的压缩包下载到 centos7.6 中根目录的 zk 文件夹中</span></pre></td></tr><tr><td data-num=\"2\"></td><td><pre><span class=\"token function\">wget</span> -P /zk https://archive.apache.org/dist/zookeeper/zookeeper-3.4.9/zookeeper-3.4.9.tar.gz</pre></td></tr><tr><td data-num=\"3\"></td><td><pre><span class=\"token comment\"># 解压</span></pre></td></tr><tr><td data-num=\"4\"></td><td><pre><span class=\"token function\">tar</span> -zxvf zookeeper-3.4.9.tar.gz</pre></td></tr></table></figure><h2 id=\"jdk\"><a class=\"anchor\" href=\"#jdk\">#</a> Jdk</h2>\n<figure class=\"highlight shell\"><figcaption data-lang=\"Bash\"></figcaption><table><tr><td data-num=\"1\"></td><td><pre><span class=\"token comment\"># 查看 jdk 软件包列表</span></pre></td></tr><tr><td data-num=\"2\"></td><td><pre>yum search java <span class=\"token operator\">|</span> <span class=\"token function\">grep</span> -i --color jdk</pre></td></tr><tr><td data-num=\"3\"></td><td><pre><span class=\"token comment\"># 选择版本安装</span></pre></td></tr><tr><td data-num=\"4\"></td><td><pre>yum <span class=\"token function\">install</span> -y java-1.8.0-openjdk*</pre></td></tr><tr><td data-num=\"5\"></td><td><pre><span class=\"token comment\"># 查看是否安装成功</span></pre></td></tr><tr><td data-num=\"6\"></td><td><pre>java -version</pre></td></tr></table></figure><h1 id=\"配置\"><a class=\"anchor\" href=\"#配置\">#</a> 配置</h1>\n<h2 id=\"单体\"><a class=\"anchor\" href=\"#单体\">#</a> 单体</h2>\n<h3 id=\"更改配置文件\"><a class=\"anchor\" href=\"#更改配置文件\">#</a> 更改配置文件</h3>\n<h4 id=\"进入conf文件夹中将zoo_samplecfg文件复制并重命名为zoocfg文件\"><a class=\"anchor\" href=\"#进入conf文件夹中将zoo_samplecfg文件复制并重命名为zoocfg文件\">#</a> 进入<strong> conf</strong> 文件夹中，将<strong> zoo_sample.cfg</strong> 文件复制并重命名为<strong> zoo.cfg</strong> 文件</h4>\n<figure class=\"highlight shell\"><figcaption data-lang=\"Bash\"></figcaption><table><tr><td data-num=\"1\"></td><td><pre><span class=\"token builtin class-name\">cd</span> /cpmf</pre></td></tr><tr><td data-num=\"2\"></td><td><pre><span class=\"token function\">cp</span> zoo_smaple.cfg zoo.cfg</pre></td></tr></table></figure><h4 id=\"创建快照和数据库事务文件保存目录\"><a class=\"anchor\" href=\"#创建快照和数据库事务文件保存目录\">#</a> 创建快照和数据库事务文件保存目录</h4>\n<figure class=\"highlight shell\"><figcaption data-lang=\"Bash\"></figcaption><table><tr><td data-num=\"1\"></td><td><pre><span class=\"token function\">mkdir</span> /zk/dataDir</pre></td></tr><tr><td data-num=\"2\"></td><td><pre><span class=\"token function\">mkdir</span> /zk/dataLogDir</pre></td></tr></table></figure><h4 id=\"编辑配置文件\"><a class=\"anchor\" href=\"#编辑配置文件\">#</a> 编辑配置文件</h4>\n<blockquote>\n<p>使用<strong> vim zoo.cfg</strong> 对配置文件进行编辑</p>\n</blockquote>\n<figure class=\"highlight shell\"><figcaption data-lang=\"Bash\"></figcaption><table><tr><td data-num=\"1\"></td><td><pre><span class=\"token comment\"># 每一秒的毫秒数</span></pre></td></tr><tr><td data-num=\"2\"></td><td><pre>tickTime <span class=\"token operator\">=</span> <span class=\"token number\">2000</span></pre></td></tr><tr><td data-num=\"3\"></td><td><pre><span class=\"token comment\"># 勾号的个数</span></pre></td></tr><tr><td data-num=\"4\"></td><td><pre><span class=\"token comment\"># 同步阶段可以采取</span></pre></td></tr><tr><td data-num=\"5\"></td><td><pre>initLimit <span class=\"token operator\">=</span> <span class=\"token number\">10</span></pre></td></tr><tr><td data-num=\"6\"></td><td><pre><span class=\"token comment\"># 可以在中间传递的刻度数</span></pre></td></tr><tr><td data-num=\"7\"></td><td><pre><span class=\"token comment\"># 发送请求并获得确认</span></pre></td></tr><tr><td data-num=\"8\"></td><td><pre>syncLimit <span class=\"token operator\">=</span> <span class=\"token number\">5</span></pre></td></tr><tr><td data-num=\"9\"></td><td><pre><span class=\"token comment\"># 快照所在的目录。</span></pre></td></tr><tr><td data-num=\"10\"></td><td><pre><span class=\"token comment\"># 不要使用 /tmp 存储，/tmp 在这里只是</span></pre></td></tr><tr><td data-num=\"11\"></td><td><pre><span class=\"token comment\"># 例子的缘故。</span></pre></td></tr><tr><td data-num=\"12\"></td><td><pre><span class=\"token assign-left variable\">dataDir</span><span class=\"token operator\">=</span>/zk/dataDir</pre></td></tr><tr><td data-num=\"13\"></td><td><pre><span class=\"token comment\"># 数据事务文件保存目录</span></pre></td></tr><tr><td data-num=\"14\"></td><td><pre><span class=\"token assign-left variable\">dataLogDir</span><span class=\"token operator\">=</span>/zk/dataLogDir</pre></td></tr><tr><td data-num=\"15\"></td><td><pre><span class=\"token comment\"># 客户端连接的端口</span></pre></td></tr><tr><td data-num=\"16\"></td><td><pre>clientPort <span class=\"token operator\">=</span> <span class=\"token number\">2181</span></pre></td></tr><tr><td data-num=\"17\"></td><td><pre><span class=\"token comment\"># 最大客户端连接数。</span></pre></td></tr><tr><td data-num=\"18\"></td><td><pre><span class=\"token comment\"># 如果你需要处理更多的客户端，增加这个</span></pre></td></tr><tr><td data-num=\"19\"></td><td><pre><span class=\"token comment\"># maxClientCnxns = 60</span></pre></td></tr><tr><td data-num=\"20\"></td><td><pre></pre></td></tr><tr><td data-num=\"21\"></td><td><pre><span class=\"token comment\"># 请务必阅读维护部分</span></pre></td></tr><tr><td data-num=\"22\"></td><td><pre><span class=\"token comment\"># 管理员指南之前打开 autopurge。</span></pre></td></tr><tr><td data-num=\"23\"></td><td><pre></pre></td></tr><tr><td data-num=\"24\"></td><td><pre><span class=\"token comment\"># http://zookeeper.apache.org/doc/current/zookeeperAdmin.html sc_maintenance</span></pre></td></tr><tr><td data-num=\"25\"></td><td><pre><span class=\"token comment\"># 在 dataDir 中保留的快照数量</span></pre></td></tr><tr><td data-num=\"26\"></td><td><pre><span class=\"token comment\"># autopurge.snapRetainCount = 3</span></pre></td></tr><tr><td data-num=\"27\"></td><td><pre><span class=\"token comment\"># 清除任务间隔以小时为单位</span></pre></td></tr><tr><td data-num=\"28\"></td><td><pre><span class=\"token comment\">#设置为 “0” 禁用自动清除功能</span></pre></td></tr><tr><td data-num=\"29\"></td><td><pre><span class=\"token comment\"># autopurge.purgeInterval = 1</span></pre></td></tr><tr><td data-num=\"30\"></td><td><pre></pre></td></tr><tr><td data-num=\"31\"></td><td><pre><span class=\"token comment\"># #度量供应商</span></pre></td></tr><tr><td data-num=\"32\"></td><td><pre><span class=\"token comment\"># https://prometheus.io Metrics 出口商</span></pre></td></tr><tr><td data-num=\"33\"></td><td><pre><span class=\"token comment\"># metricsProvider.className = org.apache.zookeeper.metrics.prometheus.PrometheusMetricsProvider</span></pre></td></tr><tr><td data-num=\"34\"></td><td><pre><span class=\"token comment\"># metricsProvider.httpPort = 7000</span></pre></td></tr><tr><td data-num=\"35\"></td><td><pre><span class=\"token comment\"># metricsProvider.exportJvmInfo = true</span></pre></td></tr></table></figure><h3 id=\"更改环境变量\"><a class=\"anchor\" href=\"#更改环境变量\">#</a> 更改环境变量</h3>\n<h4 id=\"编辑系统环境变量文件\"><a class=\"anchor\" href=\"#编辑系统环境变量文件\">#</a> 编辑系统环境变量文件</h4>\n<figure class=\"highlight shell\"><figcaption data-lang=\"Bash\"></figcaption><table><tr><td data-num=\"1\"></td><td><pre><span class=\"token function\">vim</span> /etc/profile</pre></td></tr></table></figure><h4 id=\"在其尾部加入下述内容\"><a class=\"anchor\" href=\"#在其尾部加入下述内容\">#</a> 在其尾部加入下述内容</h4>\n<figure class=\"highlight shell\"><figcaption data-lang=\"Bash\"></figcaption><table><tr><td data-num=\"1\"></td><td><pre><span class=\"token comment\"># zookeeper-3.4.9 config start</span></pre></td></tr><tr><td data-num=\"2\"></td><td><pre><span class=\"token builtin class-name\">export</span> <span class=\"token assign-left variable\">ZOOKEEPER_HOME</span><span class=\"token operator\">=</span>/zk/zookeeper-3.4.9/</pre></td></tr><tr><td data-num=\"3\"></td><td><pre><span class=\"token builtin class-name\">export</span> <span class=\"token assign-left variable\"><span class=\"token environment constant\">PATH</span></span><span class=\"token operator\">=</span><span class=\"token variable\">$ZOOKEEPER_HOME</span>/bin:<span class=\"token environment constant\">$PATH</span></pre></td></tr><tr><td data-num=\"4\"></td><td><pre><span class=\"token builtin class-name\">export</span> <span class=\"token environment constant\">PATH</span></pre></td></tr><tr><td data-num=\"5\"></td><td><pre><span class=\"token comment\"># zookeeper-3.4.9 config end</span></pre></td></tr></table></figure><h4 id=\"退出-vim-后执行下述命令使环境变量生效\"><a class=\"anchor\" href=\"#退出-vim-后执行下述命令使环境变量生效\">#</a> 退出 vim 后，执行下述命令使环境变量生效</h4>\n<figure class=\"highlight shell\"><figcaption data-lang=\"Bash\"></figcaption><table><tr><td data-num=\"1\"></td><td><pre><span class=\"token builtin class-name\">source</span> /etc/profile</pre></td></tr></table></figure><h3 id=\"关闭防火墙\"><a class=\"anchor\" href=\"#关闭防火墙\">#</a> 关闭防火墙</h3>\n<figure class=\"highlight shell\"><figcaption data-lang=\"Bash\"></figcaption><table><tr><td data-num=\"1\"></td><td><pre><span class=\"token comment\"># 暂时关闭防火墙命令</span></pre></td></tr><tr><td data-num=\"2\"></td><td><pre>systemctl stop firewalld</pre></td></tr><tr><td data-num=\"3\"></td><td><pre><span class=\"token comment\"># 查看防火墙状态</span></pre></td></tr><tr><td data-num=\"4\"></td><td><pre>systemctl status firewalld</pre></td></tr><tr><td data-num=\"5\"></td><td><pre>● firewalld.service - firewalld - dynamic firewall daemon</pre></td></tr><tr><td data-num=\"6\"></td><td><pre>   Loaded: loaded <span class=\"token punctuation\">(</span>/usr/lib/systemd/system/firewalld.service<span class=\"token punctuation\">;</span> enabled<span class=\"token punctuation\">;</span> vendor preset: enabled<span class=\"token punctuation\">)</span></pre></td></tr><tr><td data-num=\"7\"></td><td><pre>   Active: inactive <span class=\"token punctuation\">(</span>dead<span class=\"token punctuation\">)</span> since Tue <span class=\"token number\">2022</span>-03-29 <span class=\"token number\">16</span>:24:26 CST<span class=\"token punctuation\">;</span> 2min 27s ago</pre></td></tr><tr><td data-num=\"8\"></td><td><pre>     Docs: man:firewalld<span class=\"token punctuation\">(</span><span class=\"token number\">1</span><span class=\"token punctuation\">)</span></pre></td></tr><tr><td data-num=\"9\"></td><td><pre>  Process: <span class=\"token number\">9936</span> <span class=\"token assign-left variable\">ExecStart</span><span class=\"token operator\">=</span>/usr/sbin/firewalld --nofork --nopid <span class=\"token variable\">$FIREWALLD_ARGS</span> <span class=\"token punctuation\">(</span>code<span class=\"token operator\">=</span>exited, <span class=\"token assign-left variable\">status</span><span class=\"token operator\">=</span><span class=\"token number\">0</span>/SUCCESS<span class=\"token punctuation\">)</span></pre></td></tr><tr><td data-num=\"10\"></td><td><pre> Main PID: <span class=\"token number\">9936</span> <span class=\"token punctuation\">(</span>code<span class=\"token operator\">=</span>exited, <span class=\"token assign-left variable\">status</span><span class=\"token operator\">=</span><span class=\"token number\">0</span>/SUCCESS<span class=\"token punctuation\">)</span></pre></td></tr></table></figure><h2 id=\"集群最少-3-台\"><a class=\"anchor\" href=\"#集群最少-3-台\">#</a> 集群 (最少 3 台)</h2>\n<h3 id=\"更改配置文件-2\"><a class=\"anchor\" href=\"#更改配置文件-2\">#</a> 更改配置文件</h3>\n<h4 id=\"在单体的中对zoocfg配置的基础上在尾部加入\"><a class=\"anchor\" href=\"#在单体的中对zoocfg配置的基础上在尾部加入\">#</a> 在单体的中对<strong> zoo.cfg</strong> 配置的基础上，在尾部加入</h4>\n<figure class=\"highlight shell\"><figcaption data-lang=\"Bash\"></figcaption><table><tr><td data-num=\"1\"></td><td><pre>server.1<span class=\"token operator\">=</span><span class=\"token number\">192.168</span>.0.1:2888:3888</pre></td></tr><tr><td data-num=\"2\"></td><td><pre>server.2<span class=\"token operator\">=</span><span class=\"token number\">192.168</span>.0.2:2888:3888</pre></td></tr><tr><td data-num=\"3\"></td><td><pre>server.3<span class=\"token operator\">=</span><span class=\"token number\">192.168</span>.0.3:2888:3888</pre></td></tr></table></figure><blockquote>\n<p>server.A=B:C:D</p>\n</blockquote>\n<ol>\n<li>A 是一个数字，表示这个是服务器的编号</li>\n<li>B 是这个服务器 ip</li>\n<li>C 是集群内通讯端口 (默认 2888)</li>\n<li>D 是选举 leader 端口 (默认 3888)</li>\n</ol>\n<h4 id=\"创建myid文件\"><a class=\"anchor\" href=\"#创建myid文件\">#</a> 创建<strong> myid</strong> 文件</h4>\n<blockquote>\n<p>添加 myid 文件，在上边配置的 dataDir 的路径下边添加 myid 文件<br />\n注： myid 文件中，内容是跟上述 A 相对应的</p>\n</blockquote>\n<figure class=\"highlight shell\"><figcaption data-lang=\"Bash\"></figcaption><table><tr><td data-num=\"1\"></td><td><pre><span class=\"token builtin class-name\">echo</span> <span class=\"token string\">\"1\"</span> <span class=\"token operator\">></span> myid</pre></td></tr></table></figure><h3 id=\"按照上述步骤单体集群在-n-台机子上配置就好了\"><a class=\"anchor\" href=\"#按照上述步骤单体集群在-n-台机子上配置就好了\">#</a> 按照上述步骤（单体 + 集群），在 N 台机子上配置就好了</h3>\n<h1 id=\"常用命令\"><a class=\"anchor\" href=\"#常用命令\">#</a> 常用命令</h1>\n<h2 id=\"zk-服务命令\"><a class=\"anchor\" href=\"#zk-服务命令\">#</a> zk 服务命令</h2>\n<h3 id=\"启动-zk-服务\"><a class=\"anchor\" href=\"#启动-zk-服务\">#</a> 启动 ZK 服务:</h3>\n<figure class=\"highlight shell\"><figcaption data-lang=\"Bash\"></figcaption><table><tr><td data-num=\"1\"></td><td><pre>./bin/zkServer.sh start</pre></td></tr></table></figure><h3 id=\"查看-zk-服务状态\"><a class=\"anchor\" href=\"#查看-zk-服务状态\">#</a> 查看 ZK 服务状态</h3>\n<figure class=\"highlight shell\"><figcaption data-lang=\"Bash\"></figcaption><table><tr><td data-num=\"1\"></td><td><pre>./bin/zkServer.sh status</pre></td></tr></table></figure><h3 id=\"停止-zk-服务\"><a class=\"anchor\" href=\"#停止-zk-服务\">#</a> 停止 ZK 服务</h3>\n<figure class=\"highlight shell\"><figcaption data-lang=\"Bash\"></figcaption><table><tr><td data-num=\"1\"></td><td><pre>./bin/zkServer.sh stop</pre></td></tr></table></figure><h3 id=\"重启-zk-服务\"><a class=\"anchor\" href=\"#重启-zk-服务\">#</a> 重启 ZK 服务</h3>\n<figure class=\"highlight shell\"><figcaption data-lang=\"Bash\"></figcaption><table><tr><td data-num=\"1\"></td><td><pre>./bin/zkServer.sh restart</pre></td></tr></table></figure><h3 id=\"连接服务器\"><a class=\"anchor\" href=\"#连接服务器\">#</a> 连接服务器:</h3>\n<figure class=\"highlight shell\"><figcaption data-lang=\"Bash\"></figcaption><table><tr><td data-num=\"1\"></td><td><pre>./bin/zkCli.sh -server <span class=\"token number\">127.0</span>.0.1:2181</pre></td></tr></table></figure><h2 id=\"zk-客户端命令\"><a class=\"anchor\" href=\"#zk-客户端命令\">#</a> zk 客户端命令</h2>\n<h3 id=\"节点命令\"><a class=\"anchor\" href=\"#节点命令\">#</a> 节点命令</h3>\n<h4 id=\"创建节点\"><a class=\"anchor\" href=\"#创建节点\">#</a> 创建节点</h4>\n<figure class=\"highlight shell\"><figcaption data-lang=\"Bash\"></figcaption><table><tr><td data-num=\"1\"></td><td><pre>create <span class=\"token punctuation\">[</span>-s<span class=\"token punctuation\">]</span> <span class=\"token punctuation\">[</span>-e<span class=\"token punctuation\">]</span> path data <span class=\"token punctuation\">[</span>acl<span class=\"token punctuation\">]</span></pre></td></tr></table></figure><blockquote>\n<p>-s：指定节点特性：序列化（加编号）；-e：指定节点特性：临时节点。若两个都不指定，则表示创建的一个 “非序列化的持久节点 &quot; 。path：节点的<strong>完整路径</strong>。data：该节点绑定的数据。acl：权限控制</p>\n</blockquote>\n<h4 id=\"查询节点\"><a class=\"anchor\" href=\"#查询节点\">#</a> 查询节点</h4>\n<figure class=\"highlight shell\"><figcaption data-lang=\"Bash\"></figcaption><table><tr><td data-num=\"1\"></td><td><pre><span class=\"token function\">ls</span> <span class=\"token punctuation\">[</span>-s<span class=\"token punctuation\">]</span> <span class=\"token punctuation\">[</span>-w<span class=\"token punctuation\">]</span> <span class=\"token punctuation\">[</span>-R<span class=\"token punctuation\">]</span> path</pre></td></tr></table></figure><blockquote>\n<p>列出该路径节点下的所有子节点（只能获取第一级的子节点列表）；-s：指定：查询该路径节点时，除了子节点列表之外，还需要返回该节点的部分属性信息；-w：指定：查询该路径节点下的所有子节点，同时监听该节点，一旦该节点的子节点发生 CUD（增删改）操作，立即推送消息给客户端；-R：指定：返回该路径节点下的所有的子节点列表</p>\n</blockquote>\n<figure class=\"highlight shell\"><figcaption data-lang=\"Bash\"></figcaption><table><tr><td data-num=\"1\"></td><td><pre>get <span class=\"token punctuation\">[</span>-s<span class=\"token punctuation\">]</span> <span class=\"token punctuation\">[</span>-w<span class=\"token punctuation\">]</span> path</pre></td></tr></table></figure><blockquote>\n<p>获取该路径节点的数据内容（不会返回子节点列表）；-s：指定：返回该节点的数据以及属性信息；-w：指定：当该节点数据 / 属性发生改变，立即推送消息给客户端</p>\n</blockquote>\n<figure class=\"highlight shell\"><figcaption data-lang=\"Bash\"></figcaption><table><tr><td data-num=\"1\"></td><td><pre>ls2 path <span class=\"token punctuation\">[</span>watch<span class=\"token punctuation\">]</span></pre></td></tr></table></figure><blockquote>\n<p>（该查询方式与 ls -s path 类似，不过 ZK 不推荐使用该查询方式）列出该路径节点下的所有子节点（只能获取第一级的子节点列表）以及部分属性信息；watch：指定：查询该路径节点下的所有子节点，同时监听该节点，一旦该节点的子节点发生 CUD（增删改）操作，立即推送消息给客户端</p>\n</blockquote>\n<h4 id=\"更新节点\"><a class=\"anchor\" href=\"#更新节点\">#</a> 更新节点</h4>\n<figure class=\"highlight shell\"><figcaption data-lang=\"Bash\"></figcaption><table><tr><td data-num=\"1\"></td><td><pre><span class=\"token builtin class-name\">set</span> <span class=\"token punctuation\">[</span>-s<span class=\"token punctuation\">]</span> <span class=\"token punctuation\">[</span>-v version<span class=\"token punctuation\">]</span> path data</pre></td></tr></table></figure><blockquote>\n<p>data：更新的内容；-s：指定，当修改成功之后，同时返回该节点的属性。-v version 表示数据版本（ version 值要与当前节点的 最新 dataVersion 一致，否则会报错 ）</p>\n</blockquote>\n<h4 id=\"删除节点\"><a class=\"anchor\" href=\"#删除节点\">#</a> 删除节点</h4>\n<figure class=\"highlight shell\"><figcaption data-lang=\"Bash\"></figcaption><table><tr><td data-num=\"1\"></td><td><pre>delete <span class=\"token punctuation\">[</span>-v version<span class=\"token punctuation\">]</span> path</pre></td></tr></table></figure><blockquote>\n<p>删除指定路径节点（PS：如果要删除的节点存在子节点，那么必须先删除子节点，然后才能删除该节点）</p>\n</blockquote>\n<figure class=\"highlight shell\"><figcaption data-lang=\"Bash\"></figcaption><table><tr><td data-num=\"1\"></td><td><pre>deleteall path</pre></td></tr></table></figure><blockquote>\n<p>删除该路径下的所有节点（递归删除节点）</p>\n</blockquote>\n<h3 id=\"其他命令\"><a class=\"anchor\" href=\"#其他命令\">#</a> 其他命令</h3>\n<figure class=\"highlight shell\"><figcaption data-lang=\"Bash\"></figcaption><table><tr><td data-num=\"1\"></td><td><pre><span class=\"token comment\"># 退出客户端</span></pre></td></tr><tr><td data-num=\"2\"></td><td><pre>quit</pre></td></tr><tr><td data-num=\"3\"></td><td><pre><span class=\"token comment\"># 查看客户端帮助命令</span></pre></td></tr><tr><td data-num=\"4\"></td><td><pre><span class=\"token builtin class-name\">help</span></pre></td></tr><tr><td data-num=\"5\"></td><td><pre><span class=\"token comment\"># 给节点添加限制</span></pre></td></tr><tr><td data-num=\"6\"></td><td><pre>setquota -n<span class=\"token operator\">|</span>-b val path</pre></td></tr><tr><td data-num=\"7\"></td><td><pre><span class=\"token comment\"># 列出目标节点的限制</span></pre></td></tr><tr><td data-num=\"8\"></td><td><pre>listquota path</pre></td></tr><tr><td data-num=\"9\"></td><td><pre><span class=\"token comment\"># 删除目标节点的限制</span></pre></td></tr><tr><td data-num=\"10\"></td><td><pre>delquota <span class=\"token punctuation\">[</span>-n<span class=\"token operator\">|</span>-b<span class=\"token punctuation\">]</span> path</pre></td></tr><tr><td data-num=\"11\"></td><td><pre><span class=\"token comment\"># 列出最近十次的历史命令</span></pre></td></tr><tr><td data-num=\"12\"></td><td><pre><span class=\"token function\">history</span></pre></td></tr><tr><td data-num=\"13\"></td><td><pre><span class=\"token comment\"># 重新执行指定命令编号的历史命令（一般与 history 连接使用）</span></pre></td></tr><tr><td data-num=\"14\"></td><td><pre>redo cmdno</pre></td></tr><tr><td data-num=\"15\"></td><td><pre><span class=\"token comment\"># 查询节点状态</span></pre></td></tr><tr><td data-num=\"16\"></td><td><pre><span class=\"token function\">stat</span> <span class=\"token punctuation\">[</span>-w<span class=\"token punctuation\">]</span> path</pre></td></tr><tr><td data-num=\"17\"></td><td><pre><span class=\"token comment\"># 查询节点 ACL 权限</span></pre></td></tr><tr><td data-num=\"18\"></td><td><pre>getAcl <span class=\"token punctuation\">[</span>-s<span class=\"token punctuation\">]</span> path</pre></td></tr><tr><td data-num=\"19\"></td><td><pre><span class=\"token comment\"># 给上下文添加一个认真用户</span></pre></td></tr><tr><td data-num=\"20\"></td><td><pre>addauth digest <span class=\"token operator\">&lt;</span>user<span class=\"token operator\">></span>:<span class=\"token operator\">&lt;</span>password<span class=\"token operator\">></span></pre></td></tr><tr><td data-num=\"21\"></td><td><pre><span class=\"token comment\">#\tauth 模式设置节点 ACL 权限</span></pre></td></tr><tr><td data-num=\"22\"></td><td><pre>setAcl <span class=\"token punctuation\">[</span>-s<span class=\"token punctuation\">]</span> <span class=\"token punctuation\">[</span>-v version<span class=\"token punctuation\">]</span> <span class=\"token punctuation\">[</span>-R<span class=\"token punctuation\">]</span> path auth:<span class=\"token operator\">&lt;</span>user<span class=\"token operator\">></span>:<span class=\"token operator\">&lt;</span>acl<span class=\"token operator\">></span></pre></td></tr><tr><td data-num=\"23\"></td><td><pre><span class=\"token comment\">#digest 模式设置节点 ACL 权限</span></pre></td></tr><tr><td data-num=\"24\"></td><td><pre>setAcl <span class=\"token punctuation\">[</span>-s<span class=\"token punctuation\">]</span> <span class=\"token punctuation\">[</span>-v version<span class=\"token punctuation\">]</span> <span class=\"token punctuation\">[</span>-R<span class=\"token punctuation\">]</span> path digest:<span class=\"token operator\">&lt;</span>用户<span class=\"token operator\">></span>:<span class=\"token operator\">&lt;</span>密文<span class=\"token operator\">></span>:<span class=\"token operator\">&lt;</span>acl<span class=\"token operator\">></span></pre></td></tr></table></figure><h1 id=\"spring-cloud\"><a class=\"anchor\" href=\"#spring-cloud\">#</a> Spring Cloud</h1>\n<h2 id=\"依赖\"><a class=\"anchor\" href=\"#依赖\">#</a> 依赖</h2>\n<figure class=\"highlight xml\"><figcaption data-lang=\"XML\"></figcaption><table><tr><td data-num=\"1\"></td><td><pre><span class=\"token tag\"><span class=\"token tag\"><span class=\"token punctuation\">&lt;</span>dependency</span><span class=\"token punctuation\">></span></span></pre></td></tr><tr><td data-num=\"2\"></td><td><pre>            <span class=\"token tag\"><span class=\"token tag\"><span class=\"token punctuation\">&lt;</span>groupId</span><span class=\"token punctuation\">></span></span>org.springframework.cloud<span class=\"token tag\"><span class=\"token tag\"><span class=\"token punctuation\">&lt;/</span>groupId</span><span class=\"token punctuation\">></span></span></pre></td></tr><tr><td data-num=\"3\"></td><td><pre>            <span class=\"token tag\"><span class=\"token tag\"><span class=\"token punctuation\">&lt;</span>artifactId</span><span class=\"token punctuation\">></span></span>spring-cloud-starter-zookeeper-discovery<span class=\"token tag\"><span class=\"token tag\"><span class=\"token punctuation\">&lt;/</span>artifactId</span><span class=\"token punctuation\">></span></span></pre></td></tr><tr><td data-num=\"4\"></td><td><pre>            <span class=\"token tag\"><span class=\"token tag\"><span class=\"token punctuation\">&lt;</span>exclusions</span><span class=\"token punctuation\">></span></span></pre></td></tr><tr><td data-num=\"5\"></td><td><pre>                <span class=\"token tag\"><span class=\"token tag\"><span class=\"token punctuation\">&lt;</span>exclusion</span><span class=\"token punctuation\">></span></span></pre></td></tr><tr><td data-num=\"6\"></td><td><pre>                    <span class=\"token tag\"><span class=\"token tag\"><span class=\"token punctuation\">&lt;</span>groupId</span><span class=\"token punctuation\">></span></span>org.apache.zookeeper<span class=\"token tag\"><span class=\"token tag\"><span class=\"token punctuation\">&lt;/</span>groupId</span><span class=\"token punctuation\">></span></span></pre></td></tr><tr><td data-num=\"7\"></td><td><pre>                    <span class=\"token tag\"><span class=\"token tag\"><span class=\"token punctuation\">&lt;</span>artifactId</span><span class=\"token punctuation\">></span></span>zookeeper<span class=\"token tag\"><span class=\"token tag\"><span class=\"token punctuation\">&lt;/</span>artifactId</span><span class=\"token punctuation\">></span></span></pre></td></tr><tr><td data-num=\"8\"></td><td><pre>                <span class=\"token tag\"><span class=\"token tag\"><span class=\"token punctuation\">&lt;/</span>exclusion</span><span class=\"token punctuation\">></span></span></pre></td></tr><tr><td data-num=\"9\"></td><td><pre>            <span class=\"token tag\"><span class=\"token tag\"><span class=\"token punctuation\">&lt;/</span>exclusions</span><span class=\"token punctuation\">></span></span></pre></td></tr><tr><td data-num=\"10\"></td><td><pre>        <span class=\"token tag\"><span class=\"token tag\"><span class=\"token punctuation\">&lt;/</span>dependency</span><span class=\"token punctuation\">></span></span></pre></td></tr><tr><td data-num=\"11\"></td><td><pre>        <span class=\"token tag\"><span class=\"token tag\"><span class=\"token punctuation\">&lt;</span>dependency</span><span class=\"token punctuation\">></span></span></pre></td></tr><tr><td data-num=\"12\"></td><td><pre>            <span class=\"token tag\"><span class=\"token tag\"><span class=\"token punctuation\">&lt;</span>groupId</span><span class=\"token punctuation\">></span></span>org.apache.zookeeper<span class=\"token tag\"><span class=\"token tag\"><span class=\"token punctuation\">&lt;/</span>groupId</span><span class=\"token punctuation\">></span></span></pre></td></tr><tr><td data-num=\"13\"></td><td><pre>            <span class=\"token tag\"><span class=\"token tag\"><span class=\"token punctuation\">&lt;</span>artifactId</span><span class=\"token punctuation\">></span></span>zookeeper<span class=\"token tag\"><span class=\"token tag\"><span class=\"token punctuation\">&lt;/</span>artifactId</span><span class=\"token punctuation\">></span></span></pre></td></tr><tr><td data-num=\"14\"></td><td><pre>            <span class=\"token tag\"><span class=\"token tag\"><span class=\"token punctuation\">&lt;</span>version</span><span class=\"token punctuation\">></span></span>3.7.0<span class=\"token tag\"><span class=\"token tag\"><span class=\"token punctuation\">&lt;/</span>version</span><span class=\"token punctuation\">></span></span></pre></td></tr><tr><td data-num=\"15\"></td><td><pre>            <span class=\"token tag\"><span class=\"token tag\"><span class=\"token punctuation\">&lt;</span>exclusions</span><span class=\"token punctuation\">></span></span></pre></td></tr><tr><td data-num=\"16\"></td><td><pre>                <span class=\"token tag\"><span class=\"token tag\"><span class=\"token punctuation\">&lt;</span>exclusion</span><span class=\"token punctuation\">></span></span></pre></td></tr><tr><td data-num=\"17\"></td><td><pre>                    <span class=\"token tag\"><span class=\"token tag\"><span class=\"token punctuation\">&lt;</span>groupId</span><span class=\"token punctuation\">></span></span>org.slf4j<span class=\"token tag\"><span class=\"token tag\"><span class=\"token punctuation\">&lt;/</span>groupId</span><span class=\"token punctuation\">></span></span></pre></td></tr><tr><td data-num=\"18\"></td><td><pre>                    <span class=\"token tag\"><span class=\"token tag\"><span class=\"token punctuation\">&lt;</span>artifactId</span><span class=\"token punctuation\">></span></span>slf4j-log4j12<span class=\"token tag\"><span class=\"token tag\"><span class=\"token punctuation\">&lt;/</span>artifactId</span><span class=\"token punctuation\">></span></span></pre></td></tr><tr><td data-num=\"19\"></td><td><pre>                <span class=\"token tag\"><span class=\"token tag\"><span class=\"token punctuation\">&lt;/</span>exclusion</span><span class=\"token punctuation\">></span></span></pre></td></tr><tr><td data-num=\"20\"></td><td><pre>            <span class=\"token tag\"><span class=\"token tag\"><span class=\"token punctuation\">&lt;/</span>exclusions</span><span class=\"token punctuation\">></span></span></pre></td></tr><tr><td data-num=\"21\"></td><td><pre>        <span class=\"token tag\"><span class=\"token tag\"><span class=\"token punctuation\">&lt;/</span>dependency</span><span class=\"token punctuation\">></span></span></pre></td></tr></table></figure><h2 id=\"配置文件\"><a class=\"anchor\" href=\"#配置文件\">#</a> 配置文件</h2>\n<figure class=\"highlight yml\"><figcaption data-lang=\"YAML\"></figcaption><table><tr><td data-num=\"1\"></td><td><pre><span class=\"token key atrule\">spring</span><span class=\"token punctuation\">:</span></pre></td></tr><tr><td data-num=\"2\"></td><td><pre>  <span class=\"token key atrule\">application</span><span class=\"token punctuation\">:</span></pre></td></tr><tr><td data-num=\"3\"></td><td><pre>    <span class=\"token key atrule\">name</span><span class=\"token punctuation\">:</span> zk<span class=\"token punctuation\">-</span>server<span class=\"token punctuation\">-</span>name</pre></td></tr><tr><td data-num=\"4\"></td><td><pre>  <span class=\"token key atrule\">cloud</span><span class=\"token punctuation\">:</span></pre></td></tr><tr><td data-num=\"5\"></td><td><pre>    <span class=\"token key atrule\">zookeeper</span><span class=\"token punctuation\">:</span></pre></td></tr><tr><td data-num=\"6\"></td><td><pre>      <span class=\"token key atrule\">connect-string</span><span class=\"token punctuation\">:</span> 127.0.0.1<span class=\"token punctuation\">:</span><span class=\"token number\">2181</span></pre></td></tr></table></figure><h2 id=\"启动类注解\"><a class=\"anchor\" href=\"#启动类注解\">#</a> 启动类注解</h2>\n<figure class=\"highlight java\"><figcaption data-lang=\"java\"></figcaption><table><tr><td data-num=\"1\"></td><td><pre><span class=\"token annotation punctuation\">@EnableDiscoveryClient</span></pre></td></tr></table></figure><h2 id=\"服务调用\"><a class=\"anchor\" href=\"#服务调用\">#</a> 服务调用</h2>\n<h3 id=\"resttemplate-配置\"><a class=\"anchor\" href=\"#resttemplate-配置\">#</a> RestTemplate 配置</h3>\n<figure class=\"highlight java\"><figcaption data-lang=\"java\"></figcaption><table><tr><td data-num=\"1\"></td><td><pre><span class=\"token annotation punctuation\">@Configuration</span></pre></td></tr><tr><td data-num=\"2\"></td><td><pre><span class=\"token keyword\">public</span> <span class=\"token keyword\">class</span> <span class=\"token class-name\">ApplicationContextConfig</span> <span class=\"token punctuation\">&#123;</span></pre></td></tr><tr><td data-num=\"3\"></td><td><pre></pre></td></tr><tr><td data-num=\"4\"></td><td><pre>    <span class=\"token annotation punctuation\">@Bean</span></pre></td></tr><tr><td data-num=\"5\"></td><td><pre>    <span class=\"token comment\">// 赋予负载均衡能力</span></pre></td></tr><tr><td data-num=\"6\"></td><td><pre>    <span class=\"token annotation punctuation\">@LoadBalanced</span></pre></td></tr><tr><td data-num=\"7\"></td><td><pre>    <span class=\"token keyword\">public</span> <span class=\"token class-name\">RestTemplate</span> <span class=\"token function\">getRest</span><span class=\"token punctuation\">(</span><span class=\"token punctuation\">)</span> <span class=\"token punctuation\">&#123;</span></pre></td></tr><tr><td data-num=\"8\"></td><td><pre>        <span class=\"token keyword\">return</span> <span class=\"token keyword\">new</span> <span class=\"token class-name\">RestTemplate</span><span class=\"token punctuation\">(</span><span class=\"token punctuation\">)</span><span class=\"token punctuation\">;</span></pre></td></tr><tr><td data-num=\"9\"></td><td><pre>    <span class=\"token punctuation\">&#125;</span></pre></td></tr><tr><td data-num=\"10\"></td><td><pre><span class=\"token punctuation\">&#125;</span></pre></td></tr></table></figure><blockquote>\n<p>将同一注册中心的服务，通过<strong> RestTemplate</strong> 对 <span class=\"exturl\" data-url=\"aHR0cDovL3prLXNlcnZlci1uYW1lLyo=\">http://zk-server-name/*</span> 进行请求</p>\n</blockquote>\n",
            "tags": [
                "Spring Cloud",
                "注册中心",
                "微服务",
                "Java"
            ]
        },
        {
            "id": "https://dreamdivination.gitee.io/2022/03/29/Eureka/",
            "url": "https://dreamdivination.gitee.io/2022/03/29/Eureka/",
            "title": "Eureka",
            "date_published": "2022-03-28T16:00:00.000Z",
            "content_html": "<h1 id=\"概念\"><a class=\"anchor\" href=\"#概念\">#</a> 概念</h1>\n<h2 id=\"服务治理\"><a class=\"anchor\" href=\"#服务治理\">#</a> 服务治理</h2>\n<blockquote>\n<p>Spring Cloud 封装了 Netflix 公司开发的 Eureka 模块来实现服务治理</p>\n</blockquote>\n<blockquote>\n<p>在传统的 rpc 远程调用框架中，管理每个服务与服务之间依赖关系比较复杂，管理比较复杂，所以需要使用服务治理，管理服务与服务之间依赖关系，可以实现服务调用、负载均衡、容错等，实现服务发现和注册</p>\n</blockquote>\n<h2 id=\"服务注册\"><a class=\"anchor\" href=\"#服务注册\">#</a> 服务注册</h2>\n<blockquote>\n<p>Eureka 采用了 CS 的设计架构，Eureka Server 作为服务注册功能的服务器，它是服务注册中心。而系统中的其他微服务，使用 Eureka 的客户端连接到 Eureka Server 并维持心跳链接。这样系统的维护人员就可以通过 Eureka Server 来监控系统中各个微服务是否正常运行</p>\n</blockquote>\n<blockquote>\n<p>在服务注册和发现中，有一个注册中心。当服务器启动的时候，会把当前自己服务器的信息，比如：服务地址通讯地址等以别名方式注册到注册中心。另一方（消费者 | 服务提供者），该以别名的方式去注册中心上获取到实际的服务通讯地址，然后再实现本地 RPC 调用 RPC 远程调用框架核心设计思想：在于注册中心，因为使用注册中心管理每个服务与服务之间的一个依赖关系（服务治理概念）。在任何 RPC 远程框架中，都会有一个注册中心（存放服务地址相关信息（接口地址））</p>\n</blockquote>\n<h2 id=\"eureka-两大组件\"><a class=\"anchor\" href=\"#eureka-两大组件\">#</a> Eureka 两大组件</h2>\n<h3 id=\"eureka-server-提供服务注册\"><a class=\"anchor\" href=\"#eureka-server-提供服务注册\">#</a> Eureka Server 提供服务注册</h3>\n<blockquote>\n<p>各个微服务节点通过配置启动后，会在 Eureka Server 中进行注册，这样 Eureka Server 中的服务注册表中将会存储所有可用服务节点的信息，服务节点的信息可以在界面中直观看到</p>\n</blockquote>\n<h3 id=\"eureka-client-通过注册中心访问\"><a class=\"anchor\" href=\"#eureka-client-通过注册中心访问\">#</a> Eureka Client 通过注册中心访问</h3>\n<blockquote>\n<p>是一个 Java 客户端，用于简化 Eureka Server 的交互，客户端同时也具备一个内置的、使用轮询（round-robin）负载算法的负载均衡器。在应用启动后，将会向 Eureka Server 发送心跳（默认周期为 30 秒）。如果 Eureka Server 在多个心跳中期内没有接收到某个节点的心跳，Eureka Server 将会从服务注册表中把这个服务节点一处（默认 90 秒）</p>\n</blockquote>\n<h2 id=\"自我保护\"><a class=\"anchor\" href=\"#自我保护\">#</a> 自我保护</h2>\n<h3 id=\"故障现象\"><a class=\"anchor\" href=\"#故障现象\">#</a> 故障现象</h3>\n<blockquote>\n<p>主要用于一组客户端和 Eureka Server 之间存在网络分区场景下的保护。一旦进入保护模式，Eureka Server 将会尝试保护其服务注册表中的信息，不会删除服务注册表中的数据，也就是不会注销任何微服务</p>\n</blockquote>\n<h3 id=\"导致原因\"><a class=\"anchor\" href=\"#导致原因\">#</a> 导致原因</h3>\n<h4 id=\"产生原因\"><a class=\"anchor\" href=\"#产生原因\">#</a> 产生原因</h4>\n<blockquote>\n<p>为了防止 Eureka Client 正常运行时但与 Eureks Server 出现网络不通的情况下，Eureka Server<strong> 不会立刻</strong>将 Eureka Client 服务剔除</p>\n</blockquote>\n<h4 id=\"详解\"><a class=\"anchor\" href=\"#详解\">#</a> 详解</h4>\n<blockquote>\n<p>默认情况下 Eureka Client 定时向 Eureka Server 端发送心跳包。如果 Eureka 在 server 端在一定时间内（默认 90s）没有收到 Eureka Client 发送的心跳包，便会直接从服务注册列表中剔除该服务，到那时在短时间内（90s 中）内丢失了大量的微服务实例心跳，这个时候 Eureka Server 会开启自我保护机制，不会剔除该服务（该现象可能出现在如何网络不通，但是 Eureka Client 出现了宕机，此时如果换做别的注册中心如果一定时间内没有收到心跳会将剔除该服务，这样就出现了严重失误，因为客户端还能正常发送心跳，只是网络延迟问题，而保护机制是为了解决此问题而产生的）</p>\n</blockquote>\n<blockquote>\n<p><strong>自我保护模式</strong>是一种应对网络异常的安全保护措施。它的架构哲学是宁可同时保留所有微服务（健康的微服务喝不健康的微服务都会保留），也不盲目注销任何健康的微服务。使用自我保护模式，可以让 Eureka 集群更加的健壮、稳定</p>\n</blockquote>\n<h1 id=\"spring-cloud\"><a class=\"anchor\" href=\"#spring-cloud\">#</a> Spring Cloud</h1>\n<h2 id=\"单机\"><a class=\"anchor\" href=\"#单机\">#</a> 单机</h2>\n<h3 id=\"服务端\"><a class=\"anchor\" href=\"#服务端\">#</a> 服务端</h3>\n<h4 id=\"依赖\"><a class=\"anchor\" href=\"#依赖\">#</a> 依赖</h4>\n<figure class=\"highlight xml\"><figcaption data-lang=\"XML\"></figcaption><table><tr><td data-num=\"1\"></td><td><pre><span class=\"token tag\"><span class=\"token tag\"><span class=\"token punctuation\">&lt;</span>dependency</span><span class=\"token punctuation\">></span></span></pre></td></tr><tr><td data-num=\"2\"></td><td><pre>            <span class=\"token tag\"><span class=\"token tag\"><span class=\"token punctuation\">&lt;</span>groupId</span><span class=\"token punctuation\">></span></span>org.springframework.cloud<span class=\"token tag\"><span class=\"token tag\"><span class=\"token punctuation\">&lt;/</span>groupId</span><span class=\"token punctuation\">></span></span></pre></td></tr><tr><td data-num=\"3\"></td><td><pre>            <span class=\"token tag\"><span class=\"token tag\"><span class=\"token punctuation\">&lt;</span>artifactId</span><span class=\"token punctuation\">></span></span>spring-cloud-starter-netflix-eureka-server<span class=\"token tag\"><span class=\"token tag\"><span class=\"token punctuation\">&lt;/</span>artifactId</span><span class=\"token punctuation\">></span></span></pre></td></tr><tr><td data-num=\"4\"></td><td><pre>        <span class=\"token tag\"><span class=\"token tag\"><span class=\"token punctuation\">&lt;/</span>dependency</span><span class=\"token punctuation\">></span></span></pre></td></tr></table></figure><h4 id=\"配置文件\"><a class=\"anchor\" href=\"#配置文件\">#</a> 配置文件</h4>\n<figure class=\"highlight yml\"><figcaption data-lang=\"YAML\"></figcaption><table><tr><td data-num=\"1\"></td><td><pre><span class=\"token key atrule\">spring</span><span class=\"token punctuation\">:</span></pre></td></tr><tr><td data-num=\"2\"></td><td><pre>  <span class=\"token key atrule\">application</span><span class=\"token punctuation\">:</span></pre></td></tr><tr><td data-num=\"3\"></td><td><pre>    <span class=\"token key atrule\">name</span><span class=\"token punctuation\">:</span> eureka<span class=\"token punctuation\">-</span>server<span class=\"token punctuation\">-</span>name</pre></td></tr><tr><td data-num=\"4\"></td><td><pre><span class=\"token key atrule\">eureka</span><span class=\"token punctuation\">:</span></pre></td></tr><tr><td data-num=\"5\"></td><td><pre>  <span class=\"token key atrule\">instance</span><span class=\"token punctuation\">:</span></pre></td></tr><tr><td data-num=\"6\"></td><td><pre>    <span class=\"token key atrule\">hostname</span><span class=\"token punctuation\">:</span> localhost</pre></td></tr><tr><td data-num=\"7\"></td><td><pre>  <span class=\"token key atrule\">client</span><span class=\"token punctuation\">:</span></pre></td></tr><tr><td data-num=\"8\"></td><td><pre>    <span class=\"token key atrule\">register-with-eureka</span><span class=\"token punctuation\">:</span> <span class=\"token boolean important\">false</span></pre></td></tr><tr><td data-num=\"9\"></td><td><pre>    <span class=\"token key atrule\">fetch-registry</span><span class=\"token punctuation\">:</span> <span class=\"token boolean important\">false</span></pre></td></tr><tr><td data-num=\"10\"></td><td><pre>    <span class=\"token key atrule\">service-url</span><span class=\"token punctuation\">:</span></pre></td></tr><tr><td data-num=\"11\"></td><td><pre>      <span class=\"token key atrule\">defaultZone</span><span class=\"token punctuation\">:</span> http<span class=\"token punctuation\">:</span>//$<span class=\"token punctuation\">&#123;</span>eureka.instance.hostname<span class=\"token punctuation\">&#125;</span><span class=\"token punctuation\">:</span>$<span class=\"token punctuation\">&#123;</span>server.port<span class=\"token punctuation\">&#125;</span>/eureka</pre></td></tr></table></figure><h4 id=\"启动类注解\"><a class=\"anchor\" href=\"#启动类注解\">#</a> 启动类注解</h4>\n<figure class=\"highlight java\"><figcaption data-lang=\"java\"></figcaption><table><tr><td data-num=\"1\"></td><td><pre><span class=\"token annotation punctuation\">@EnableEurekaServer</span></pre></td></tr></table></figure><h3 id=\"客户端\"><a class=\"anchor\" href=\"#客户端\">#</a> 客户端</h3>\n<h4 id=\"依赖-2\"><a class=\"anchor\" href=\"#依赖-2\">#</a> 依赖</h4>\n<figure class=\"highlight xml\"><figcaption data-lang=\"XML\"></figcaption><table><tr><td data-num=\"1\"></td><td><pre><span class=\"token tag\"><span class=\"token tag\"><span class=\"token punctuation\">&lt;</span>dependency</span><span class=\"token punctuation\">></span></span></pre></td></tr><tr><td data-num=\"2\"></td><td><pre>            <span class=\"token tag\"><span class=\"token tag\"><span class=\"token punctuation\">&lt;</span>groupId</span><span class=\"token punctuation\">></span></span>org.springframework.cloud<span class=\"token tag\"><span class=\"token tag\"><span class=\"token punctuation\">&lt;/</span>groupId</span><span class=\"token punctuation\">></span></span></pre></td></tr><tr><td data-num=\"3\"></td><td><pre>            <span class=\"token tag\"><span class=\"token tag\"><span class=\"token punctuation\">&lt;</span>artifactId</span><span class=\"token punctuation\">></span></span>spring-cloud-starter-netflix-eureka-client<span class=\"token tag\"><span class=\"token tag\"><span class=\"token punctuation\">&lt;/</span>artifactId</span><span class=\"token punctuation\">></span></span></pre></td></tr><tr><td data-num=\"4\"></td><td><pre>        <span class=\"token tag\"><span class=\"token tag\"><span class=\"token punctuation\">&lt;/</span>dependency</span><span class=\"token punctuation\">></span></span></pre></td></tr></table></figure><h4 id=\"配置文件-2\"><a class=\"anchor\" href=\"#配置文件-2\">#</a> 配置文件</h4>\n<figure class=\"highlight yml\"><figcaption data-lang=\"YAML\"></figcaption><table><tr><td data-num=\"1\"></td><td><pre><span class=\"token key atrule\">spring</span><span class=\"token punctuation\">:</span></pre></td></tr><tr><td data-num=\"2\"></td><td><pre>  <span class=\"token key atrule\">application</span><span class=\"token punctuation\">:</span></pre></td></tr><tr><td data-num=\"3\"></td><td><pre>    <span class=\"token key atrule\">name</span><span class=\"token punctuation\">:</span> eureka<span class=\"token punctuation\">-</span>client<span class=\"token punctuation\">-</span>name</pre></td></tr><tr><td data-num=\"4\"></td><td><pre><span class=\"token key atrule\">eureka</span><span class=\"token punctuation\">:</span></pre></td></tr><tr><td data-num=\"5\"></td><td><pre>  <span class=\"token key atrule\">client</span><span class=\"token punctuation\">:</span></pre></td></tr><tr><td data-num=\"6\"></td><td><pre>    <span class=\"token key atrule\">register-with-eureka</span><span class=\"token punctuation\">:</span> <span class=\"token boolean important\">true</span></pre></td></tr><tr><td data-num=\"7\"></td><td><pre>    <span class=\"token key atrule\">fetchRegistry</span><span class=\"token punctuation\">:</span> <span class=\"token boolean important\">true</span></pre></td></tr><tr><td data-num=\"8\"></td><td><pre>    <span class=\"token key atrule\">service-url</span><span class=\"token punctuation\">:</span></pre></td></tr><tr><td data-num=\"9\"></td><td><pre>      <span class=\"token comment\"># Eureka Server 的 eureka.instance.hostname 和 server.port</span></pre></td></tr><tr><td data-num=\"10\"></td><td><pre>      <span class=\"token key atrule\">defaultZone</span><span class=\"token punctuation\">:</span> http<span class=\"token punctuation\">:</span>//hostname<span class=\"token punctuation\">:</span>port/eureka</pre></td></tr></table></figure><h4 id=\"启动类注解-2\"><a class=\"anchor\" href=\"#启动类注解-2\">#</a> 启动类注解</h4>\n<figure class=\"highlight java\"><figcaption data-lang=\"java\"></figcaption><table><tr><td data-num=\"1\"></td><td><pre><span class=\"token annotation punctuation\">@EnableEurekaClient</span></pre></td></tr></table></figure><h2 id=\"集群\"><a class=\"anchor\" href=\"#集群\">#</a> 集群</h2>\n<h3 id=\"说明\"><a class=\"anchor\" href=\"#说明\">#</a> 说明</h3>\n<blockquote>\n<p>服务注册：将服务信息注册进注册中心<br />\n服务发现：从注册中心获取信息<br />\n实质：存 key 服务命名，取 value 调用地址</p>\n</blockquote>\n<blockquote>\n<p>微服务 RPC 远程服务调用核心是：高可用（实现：搭建注册中心集群，实现负载均衡和故障容错）</p>\n</blockquote>\n<h3 id=\"服务端-配置文件\"><a class=\"anchor\" href=\"#服务端-配置文件\">#</a> 服务端 - 配置文件</h3>\n<figure class=\"highlight yml\"><figcaption data-lang=\"YAML\"></figcaption><table><tr><td data-num=\"1\"></td><td><pre><span class=\"token key atrule\">spring</span><span class=\"token punctuation\">:</span></pre></td></tr><tr><td data-num=\"2\"></td><td><pre>  <span class=\"token key atrule\">application</span><span class=\"token punctuation\">:</span></pre></td></tr><tr><td data-num=\"3\"></td><td><pre>    <span class=\"token key atrule\">name</span><span class=\"token punctuation\">:</span> eureka<span class=\"token punctuation\">-</span>server<span class=\"token punctuation\">-</span>name</pre></td></tr><tr><td data-num=\"4\"></td><td><pre></pre></td></tr><tr><td data-num=\"5\"></td><td><pre><span class=\"token key atrule\">eureka</span><span class=\"token punctuation\">:</span></pre></td></tr><tr><td data-num=\"6\"></td><td><pre>  <span class=\"token key atrule\">instance</span><span class=\"token punctuation\">:</span></pre></td></tr><tr><td data-num=\"7\"></td><td><pre>    <span class=\"token comment\"># 本地需要做代理、局域网若不使用 IP 则也需要做代理</span></pre></td></tr><tr><td data-num=\"8\"></td><td><pre>    <span class=\"token key atrule\">hostname</span><span class=\"token punctuation\">:</span> eureka.server1</pre></td></tr><tr><td data-num=\"9\"></td><td><pre>  <span class=\"token key atrule\">client</span><span class=\"token punctuation\">:</span></pre></td></tr><tr><td data-num=\"10\"></td><td><pre>    <span class=\"token key atrule\">register-with-eureka</span><span class=\"token punctuation\">:</span> <span class=\"token boolean important\">false</span></pre></td></tr><tr><td data-num=\"11\"></td><td><pre>    <span class=\"token key atrule\">fetch-registry</span><span class=\"token punctuation\">:</span> <span class=\"token boolean important\">false</span></pre></td></tr><tr><td data-num=\"12\"></td><td><pre>    <span class=\"token key atrule\">service-url</span><span class=\"token punctuation\">:</span></pre></td></tr><tr><td data-num=\"13\"></td><td><pre>      <span class=\"token comment\"># eureka-server-1 注册入 eureka-server-2（eureka.instance.hostname 和 server.port），多者相互注册个用 \",\" 隔开</span></pre></td></tr><tr><td data-num=\"14\"></td><td><pre>      <span class=\"token key atrule\">defaultZone</span><span class=\"token punctuation\">:</span> http<span class=\"token punctuation\">:</span>//eureka.server2<span class=\"token punctuation\">:</span>server2.port/eureka</pre></td></tr></table></figure><h3 id=\"客户端端-配置文件\"><a class=\"anchor\" href=\"#客户端端-配置文件\">#</a> 客户端端 - 配置文件</h3>\n<figure class=\"highlight yml\"><figcaption data-lang=\"YAML\"></figcaption><table><tr><td data-num=\"1\"></td><td><pre><span class=\"token key atrule\">spring</span><span class=\"token punctuation\">:</span></pre></td></tr><tr><td data-num=\"2\"></td><td><pre>  <span class=\"token key atrule\">application</span><span class=\"token punctuation\">:</span></pre></td></tr><tr><td data-num=\"3\"></td><td><pre>    <span class=\"token key atrule\">name</span><span class=\"token punctuation\">:</span> eureka<span class=\"token punctuation\">-</span>client<span class=\"token punctuation\">-</span>name</pre></td></tr><tr><td data-num=\"4\"></td><td><pre></pre></td></tr><tr><td data-num=\"5\"></td><td><pre><span class=\"token key atrule\">eureka</span><span class=\"token punctuation\">:</span></pre></td></tr><tr><td data-num=\"6\"></td><td><pre>  <span class=\"token key atrule\">client</span><span class=\"token punctuation\">:</span></pre></td></tr><tr><td data-num=\"7\"></td><td><pre>    <span class=\"token key atrule\">register-with-eureka</span><span class=\"token punctuation\">:</span> <span class=\"token boolean important\">true</span></pre></td></tr><tr><td data-num=\"8\"></td><td><pre>    <span class=\"token key atrule\">fetch-registry</span><span class=\"token punctuation\">:</span> <span class=\"token boolean important\">true</span></pre></td></tr><tr><td data-num=\"9\"></td><td><pre>    <span class=\"token key atrule\">service-url</span><span class=\"token punctuation\">:</span></pre></td></tr><tr><td data-num=\"10\"></td><td><pre>      <span class=\"token key atrule\">defaultZone</span><span class=\"token punctuation\">:</span> http<span class=\"token punctuation\">:</span>//eureka.server1<span class=\"token punctuation\">:</span>server1.port/eureka<span class=\"token punctuation\">,</span>http<span class=\"token punctuation\">:</span>//eureka.server2<span class=\"token punctuation\">:</span>server2.port/eureka</pre></td></tr></table></figure><h2 id=\"服务调用\"><a class=\"anchor\" href=\"#服务调用\">#</a> 服务调用</h2>\n<h3 id=\"resttemplate-配置\"><a class=\"anchor\" href=\"#resttemplate-配置\">#</a> RestTemplate 配置</h3>\n<figure class=\"highlight java\"><figcaption data-lang=\"java\"></figcaption><table><tr><td data-num=\"1\"></td><td><pre><span class=\"token annotation punctuation\">@Configuration</span></pre></td></tr><tr><td data-num=\"2\"></td><td><pre><span class=\"token keyword\">public</span> <span class=\"token keyword\">class</span> <span class=\"token class-name\">ApplicationContextConfig</span> <span class=\"token punctuation\">&#123;</span></pre></td></tr><tr><td data-num=\"3\"></td><td><pre></pre></td></tr><tr><td data-num=\"4\"></td><td><pre>    <span class=\"token annotation punctuation\">@Bean</span></pre></td></tr><tr><td data-num=\"5\"></td><td><pre>    <span class=\"token comment\">// 赋予负载均衡能力</span></pre></td></tr><tr><td data-num=\"6\"></td><td><pre>    <span class=\"token annotation punctuation\">@LoadBalanced</span></pre></td></tr><tr><td data-num=\"7\"></td><td><pre>    <span class=\"token keyword\">public</span> <span class=\"token class-name\">RestTemplate</span> <span class=\"token function\">getRest</span><span class=\"token punctuation\">(</span><span class=\"token punctuation\">)</span> <span class=\"token punctuation\">&#123;</span></pre></td></tr><tr><td data-num=\"8\"></td><td><pre>        <span class=\"token keyword\">return</span> <span class=\"token keyword\">new</span> <span class=\"token class-name\">RestTemplate</span><span class=\"token punctuation\">(</span><span class=\"token punctuation\">)</span><span class=\"token punctuation\">;</span></pre></td></tr><tr><td data-num=\"9\"></td><td><pre>    <span class=\"token punctuation\">&#125;</span></pre></td></tr><tr><td data-num=\"10\"></td><td><pre><span class=\"token punctuation\">&#125;</span></pre></td></tr></table></figure><blockquote>\n<p>将同一注册中心的服务，通过<strong> RestTemplate</strong> 对 <span class=\"exturl\" data-url=\"aHR0cDovL2V1cmVrYS1jbGllbnQtbmFtZS8q\">http://eureka-client-name/*</span> 进行请求</p>\n</blockquote>\n<h2 id=\"服务发现\"><a class=\"anchor\" href=\"#服务发现\">#</a> 服务发现</h2>\n<h3 id=\"启动类注解-3\"><a class=\"anchor\" href=\"#启动类注解-3\">#</a> 启动类注解</h3>\n<figure class=\"highlight java\"><figcaption data-lang=\"java\"></figcaption><table><tr><td data-num=\"1\"></td><td><pre><span class=\"token annotation punctuation\">@EnableDiscoveryClient</span></pre></td></tr></table></figure><h3 id=\"controller-内容\"><a class=\"anchor\" href=\"#controller-内容\">#</a> Controller 内容</h3>\n<figure class=\"highlight java\"><figcaption data-lang=\"java\"></figcaption><table><tr><td data-num=\"1\"></td><td><pre><span class=\"token keyword\">import</span> <span class=\"token namespace\">org<span class=\"token punctuation\">.</span>springframework<span class=\"token punctuation\">.</span>cloud<span class=\"token punctuation\">.</span>client<span class=\"token punctuation\">.</span>discovery<span class=\"token punctuation\">.</span></span><span class=\"token class-name\">DiscoveryClient</span><span class=\"token punctuation\">;</span></pre></td></tr><tr><td data-num=\"2\"></td><td><pre></pre></td></tr><tr><td data-num=\"3\"></td><td><pre>    <span class=\"token annotation punctuation\">@Resource</span></pre></td></tr><tr><td data-num=\"4\"></td><td><pre>    <span class=\"token keyword\">private</span> <span class=\"token class-name\">DiscoveryClient</span> discoveryClient<span class=\"token punctuation\">;</span></pre></td></tr><tr><td data-num=\"5\"></td><td><pre></pre></td></tr><tr><td data-num=\"6\"></td><td><pre>    <span class=\"token annotation punctuation\">@GetMapping</span><span class=\"token punctuation\">(</span>value <span class=\"token operator\">=</span> <span class=\"token string\">\"discovery\"</span><span class=\"token punctuation\">)</span></pre></td></tr><tr><td data-num=\"7\"></td><td><pre>    <span class=\"token keyword\">public</span> <span class=\"token class-name\">Result</span> <span class=\"token function\">discovery</span><span class=\"token punctuation\">(</span><span class=\"token punctuation\">)</span> <span class=\"token punctuation\">&#123;</span></pre></td></tr><tr><td data-num=\"8\"></td><td><pre>        <span class=\"token comment\">// 获取所有的微服务</span></pre></td></tr><tr><td data-num=\"9\"></td><td><pre>        <span class=\"token class-name\">List</span><span class=\"token generics\"><span class=\"token punctuation\">&lt;</span><span class=\"token class-name\">String</span><span class=\"token punctuation\">></span></span> services <span class=\"token operator\">=</span> discoveryClient<span class=\"token punctuation\">.</span><span class=\"token function\">getServices</span><span class=\"token punctuation\">(</span><span class=\"token punctuation\">)</span><span class=\"token punctuation\">;</span></pre></td></tr><tr><td data-num=\"10\"></td><td><pre>        services<span class=\"token punctuation\">.</span><span class=\"token function\">forEach</span><span class=\"token punctuation\">(</span>log<span class=\"token operator\">::</span><span class=\"token function\">info</span><span class=\"token punctuation\">)</span><span class=\"token punctuation\">;</span></pre></td></tr><tr><td data-num=\"11\"></td><td><pre></pre></td></tr><tr><td data-num=\"12\"></td><td><pre>        <span class=\"token comment\">// 得到一个具体的微服务的所有实例</span></pre></td></tr><tr><td data-num=\"13\"></td><td><pre>        <span class=\"token class-name\">List</span><span class=\"token generics\"><span class=\"token punctuation\">&lt;</span><span class=\"token class-name\">ServiceInstance</span><span class=\"token punctuation\">></span></span> instances <span class=\"token operator\">=</span> discoveryClient<span class=\"token punctuation\">.</span><span class=\"token function\">getInstances</span><span class=\"token punctuation\">(</span><span class=\"token string\">\"eureka-client-name\"</span><span class=\"token punctuation\">)</span><span class=\"token punctuation\">;</span></pre></td></tr><tr><td data-num=\"14\"></td><td><pre>        instances<span class=\"token punctuation\">.</span><span class=\"token function\">forEach</span><span class=\"token punctuation\">(</span>i <span class=\"token operator\">-></span> <span class=\"token punctuation\">&#123;</span></pre></td></tr><tr><td data-num=\"15\"></td><td><pre>            log<span class=\"token punctuation\">.</span><span class=\"token function\">info</span><span class=\"token punctuation\">(</span><span class=\"token string\">\"&#123;&#125; \\t &#123;&#125; \\t &#123;&#125; \\t &#123;&#125;\"</span><span class=\"token punctuation\">,</span> i<span class=\"token punctuation\">.</span><span class=\"token function\">getInstanceId</span><span class=\"token punctuation\">(</span><span class=\"token punctuation\">)</span><span class=\"token punctuation\">,</span> i<span class=\"token punctuation\">.</span><span class=\"token function\">getHost</span><span class=\"token punctuation\">(</span><span class=\"token punctuation\">)</span><span class=\"token punctuation\">,</span> i<span class=\"token punctuation\">.</span><span class=\"token function\">getPort</span><span class=\"token punctuation\">(</span><span class=\"token punctuation\">)</span><span class=\"token punctuation\">,</span> i<span class=\"token punctuation\">.</span><span class=\"token function\">getUri</span><span class=\"token punctuation\">(</span><span class=\"token punctuation\">)</span><span class=\"token punctuation\">)</span><span class=\"token punctuation\">;</span></pre></td></tr><tr><td data-num=\"16\"></td><td><pre>        <span class=\"token punctuation\">&#125;</span><span class=\"token punctuation\">)</span><span class=\"token punctuation\">;</span></pre></td></tr><tr><td data-num=\"17\"></td><td><pre>        <span class=\"token keyword\">return</span> <span class=\"token class-name\">Result</span><span class=\"token punctuation\">.</span><span class=\"token function\">ok</span><span class=\"token punctuation\">(</span><span class=\"token punctuation\">)</span><span class=\"token punctuation\">.</span><span class=\"token function\">data</span><span class=\"token punctuation\">(</span>discoveryClient<span class=\"token punctuation\">)</span><span class=\"token punctuation\">;</span></pre></td></tr><tr><td data-num=\"18\"></td><td><pre>    <span class=\"token punctuation\">&#125;</span></pre></td></tr></table></figure><h2 id=\"关闭自我保护模式\"><a class=\"anchor\" href=\"#关闭自我保护模式\">#</a> 关闭自我保护模式</h2>\n<h3 id=\"服务端-2\"><a class=\"anchor\" href=\"#服务端-2\">#</a> 服务端</h3>\n<figure class=\"highlight yml\"><figcaption data-lang=\"YAML\"></figcaption><table><tr><td data-num=\"1\"></td><td><pre><span class=\"token key atrule\">eureka</span><span class=\"token punctuation\">:</span></pre></td></tr><tr><td data-num=\"2\"></td><td><pre>  <span class=\"token key atrule\">server</span><span class=\"token punctuation\">:</span></pre></td></tr><tr><td data-num=\"3\"></td><td><pre>    <span class=\"token key atrule\">enable-self-preservation</span><span class=\"token punctuation\">:</span> <span class=\"token boolean important\">false</span></pre></td></tr></table></figure><h1 id=\"配置文件详解\"><a class=\"anchor\" href=\"#配置文件详解\">#</a> 配置文件详解</h1>\n<h2 id=\"server\"><a class=\"anchor\" href=\"#server\">#</a> server</h2>\n<figure class=\"highlight yml\"><figcaption data-lang=\"YAML\"></figcaption><table><tr><td data-num=\"1\"></td><td><pre><span class=\"token key atrule\">eureka</span><span class=\"token punctuation\">:</span></pre></td></tr><tr><td data-num=\"2\"></td><td><pre>  <span class=\"token key atrule\">server</span><span class=\"token punctuation\">:</span></pre></td></tr><tr><td data-num=\"3\"></td><td><pre>    <span class=\"token comment\"># server 清理无效节点的时间间隔</span></pre></td></tr><tr><td data-num=\"4\"></td><td><pre>    <span class=\"token key atrule\">eviction-interval-timer-in-ms</span><span class=\"token punctuation\">:</span> <span class=\"token number\">60</span></pre></td></tr><tr><td data-num=\"5\"></td><td><pre>    <span class=\"token comment\"># 是否开启自我保护</span></pre></td></tr><tr><td data-num=\"6\"></td><td><pre>    <span class=\"token key atrule\">enable-self-preservation</span><span class=\"token punctuation\">:</span> <span class=\"token boolean important\">true</span></pre></td></tr><tr><td data-num=\"7\"></td><td><pre>    <span class=\"token comment\"># 开启自我保护的系数</span></pre></td></tr><tr><td data-num=\"8\"></td><td><pre>    <span class=\"token key atrule\">renewal-percent-threshold</span><span class=\"token punctuation\">:</span> <span class=\"token number\">0.85</span></pre></td></tr></table></figure><h2 id=\"client\"><a class=\"anchor\" href=\"#client\">#</a> client</h2>\n<figure class=\"highlight yml\"><figcaption data-lang=\"YAML\"></figcaption><table><tr><td data-num=\"1\"></td><td><pre><span class=\"token key atrule\">eureka</span><span class=\"token punctuation\">:</span></pre></td></tr><tr><td data-num=\"2\"></td><td><pre>  <span class=\"token key atrule\">client</span><span class=\"token punctuation\">:</span></pre></td></tr><tr><td data-num=\"3\"></td><td><pre>    <span class=\"token comment\"># 是否开启 client</span></pre></td></tr><tr><td data-num=\"4\"></td><td><pre>    <span class=\"token key atrule\">enabled</span><span class=\"token punctuation\">:</span> <span class=\"token boolean important\">true</span></pre></td></tr><tr><td data-num=\"5\"></td><td><pre>    <span class=\"token comment\"># 是否注册</span></pre></td></tr><tr><td data-num=\"6\"></td><td><pre>    <span class=\"token key atrule\">register-with-eureka</span><span class=\"token punctuation\">:</span> <span class=\"token boolean important\">true</span></pre></td></tr><tr><td data-num=\"7\"></td><td><pre>    <span class=\"token comment\"># 是否检索服务</span></pre></td></tr><tr><td data-num=\"8\"></td><td><pre>    <span class=\"token key atrule\">fetch-registry</span><span class=\"token punctuation\">:</span> <span class=\"token boolean important\">true</span></pre></td></tr><tr><td data-num=\"9\"></td><td><pre>    <span class=\"token comment\"># 列出所有可用注册中心的地址</span></pre></td></tr><tr><td data-num=\"10\"></td><td><pre>    <span class=\"token key atrule\">service-url</span><span class=\"token punctuation\">:</span></pre></td></tr><tr><td data-num=\"11\"></td><td><pre>      <span class=\"token comment\"># 默认服务注册中心地址  多个用 \",\" 隔开</span></pre></td></tr><tr><td data-num=\"12\"></td><td><pre>      <span class=\"token key atrule\">defaultZone</span><span class=\"token punctuation\">:</span> http<span class=\"token punctuation\">:</span>//localhost<span class=\"token punctuation\">:</span>8761/eureka/</pre></td></tr><tr><td data-num=\"13\"></td><td><pre>    <span class=\"token comment\"># 连接 server 服务器超时时间</span></pre></td></tr><tr><td data-num=\"14\"></td><td><pre>    <span class=\"token key atrule\">eureka-server-connect-timeout-seconds</span><span class=\"token punctuation\">:</span> <span class=\"token number\">5</span></pre></td></tr><tr><td data-num=\"15\"></td><td><pre>    <span class=\"token comment\"># 连接 server 的连接空闲时长</span></pre></td></tr><tr><td data-num=\"16\"></td><td><pre>    <span class=\"token key atrule\">eureka-connection-idle-timeout-seconds</span><span class=\"token punctuation\">:</span> <span class=\"token number\">30</span></pre></td></tr><tr><td data-num=\"17\"></td><td><pre>    <span class=\"token comment\"># 连接 server 读取数据超时时间</span></pre></td></tr><tr><td data-num=\"18\"></td><td><pre>    <span class=\"token key atrule\">eureka-server-read-timeout-seconds</span><span class=\"token punctuation\">:</span> <span class=\"token number\">8</span></pre></td></tr><tr><td data-num=\"19\"></td><td><pre>    <span class=\"token comment\"># 连接 server 的最大连接数</span></pre></td></tr><tr><td data-num=\"20\"></td><td><pre>    <span class=\"token key atrule\">eureka-server-total-connections</span><span class=\"token punctuation\">:</span> <span class=\"token number\">200</span></pre></td></tr><tr><td data-num=\"21\"></td><td><pre>    <span class=\"token comment\"># 对单个 server 的最大连接数</span></pre></td></tr><tr><td data-num=\"22\"></td><td><pre>    <span class=\"token key atrule\">eureka-server-total-connections-per-host</span><span class=\"token punctuation\">:</span> <span class=\"token number\">50</span></pre></td></tr><tr><td data-num=\"23\"></td><td><pre>    <span class=\"token comment\"># 获取集群中最新的 server 节点数据</span></pre></td></tr><tr><td data-num=\"24\"></td><td><pre>    <span class=\"token key atrule\">eureka-service-url-poll-interval-seconds</span><span class=\"token punctuation\">:</span> <span class=\"token number\">0</span></pre></td></tr><tr><td data-num=\"25\"></td><td><pre>    <span class=\"token comment\"># client 维持与 server 的心跳线程数</span></pre></td></tr><tr><td data-num=\"26\"></td><td><pre>    <span class=\"token key atrule\">heartbeat-executor-thread-pool-size</span><span class=\"token punctuation\">:</span> <span class=\"token number\">2</span></pre></td></tr></table></figure><h2 id=\"instance\"><a class=\"anchor\" href=\"#instance\">#</a> instance</h2>\n<figure class=\"highlight yml\"><figcaption data-lang=\"YAML\"></figcaption><table><tr><td data-num=\"1\"></td><td><pre><span class=\"token key atrule\">eureka</span><span class=\"token punctuation\">:</span></pre></td></tr><tr><td data-num=\"2\"></td><td><pre>  <span class=\"token key atrule\">instance</span><span class=\"token punctuation\">:</span></pre></td></tr><tr><td data-num=\"3\"></td><td><pre>    <span class=\"token comment\"># 服务续约任务调用间隔时间  client 每隔 30 秒向 server 上报自己状态，避免被 server 剔除</span></pre></td></tr><tr><td data-num=\"4\"></td><td><pre>    <span class=\"token key atrule\">lease-renewal-interval-in-seconds</span><span class=\"token punctuation\">:</span> <span class=\"token number\">30</span></pre></td></tr><tr><td data-num=\"5\"></td><td><pre>    <span class=\"token comment\"># 服务时效时间  当 server 90 秒内没有收到 client 的注册信息时，会将该节点剔除</span></pre></td></tr><tr><td data-num=\"6\"></td><td><pre>    <span class=\"token key atrule\">lease-expiration-duration-in-seconds</span><span class=\"token punctuation\">:</span> <span class=\"token number\">90</span></pre></td></tr><tr><td data-num=\"7\"></td><td><pre>    <span class=\"token comment\"># 注册服务时是否使用 IP 注册</span></pre></td></tr><tr><td data-num=\"8\"></td><td><pre>    <span class=\"token key atrule\">prefer-ip-address</span><span class=\"token punctuation\">:</span> <span class=\"token boolean important\">false</span></pre></td></tr><tr><td data-num=\"9\"></td><td><pre>    <span class=\"token comment\"># server 端的 ip 地址</span></pre></td></tr><tr><td data-num=\"10\"></td><td><pre>    <span class=\"token key atrule\">ip-address</span><span class=\"token punctuation\">:</span></pre></td></tr><tr><td data-num=\"11\"></td><td><pre>    <span class=\"token comment\"># server 端的 hostname</span></pre></td></tr><tr><td data-num=\"12\"></td><td><pre>    <span class=\"token key atrule\">hostname</span><span class=\"token punctuation\">:</span> localhost</pre></td></tr><tr><td data-num=\"13\"></td><td><pre>    <span class=\"token comment\"># 注册到 server 的实例</span></pre></td></tr><tr><td data-num=\"14\"></td><td><pre>    instance<span class=\"token punctuation\">-</span>id<span class=\"token punctuation\">:</span></pre></td></tr></table></figure><pre><code>\n</code></pre>\n",
            "tags": [
                "Spring Cloud",
                "注册中心",
                "微服务",
                "Java"
            ]
        }
    ]
}